<Config >
<!-- GPI DRP Primitives Config File - for pipepine, recipe editor, etc. 
This file was autogenerated by make_primitive_config.pro based on IDL doc headers -->
<!-- Module Names to IDL functions map -->
 <Primitive Name="Calibrate Photometric Flux" IDLFunc="apply_photometric_cal" Comment=" Apply photometric calibration using satellite flux " Order=" 2.51" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="FinalUnits" Type="int" Range="[0,10]" Default="1" Desc="0:Counts, 1:Counts/s, 2:ph/s/nm/m^2, 3:Jy, 4:W/m^2/um, 5:ergs/s/cm^2/A, 6:ergs/s/cm^2/Hz" />
     <Argument  Name="CalibrationFile" Type="fluxcal" Default="AUTOMATIC" Desc="Filename of the desired flux calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Calibrate Photometric Flux and save convertion in DB" IDLFunc="apply_photometric_cal_02" Comment=" Apply photometric calibration using satellite flux " Order=" 2.51" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="FinalUnits" Type="int" Range="[0,10]" Default="1" Desc="0:Counts, 1:Counts/s, 2:ph/s/nm/m^2, 3:Jy, 4:W/m^2/um, 5:ergs/s/cm^2/A, 6:ergs/s/cm^2/Hz" />
     <Argument  Name="CalibrationFile" Type="fluxcal" Default="AUTOMATIC" Desc="Filename of the desired flux calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Save_flux_convertion" Type="int" Range="[0,1]" Default="1" Desc="1: save flux convertion factor on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Calibrate Photometric Flux of extented object" IDLFunc="apply_photometric_cal_extented" Comment=" Apply photometric calibration of extented object " Order=" 2.51" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="FinalUnits" Type="int" Range="[0,10]" Default="1" Desc="0:Counts, 1:Counts/s, 2:ph/s/nm/m^2, 3:Jy, 4:W/m^2/um, 5:ergs/s/cm^2/A, 6:ergs/s/cm^2/Hz" />
     <Argument  Name="CalibrationFile" Type="Fluxconv" Default="AUTOMATIC" Desc="Filename of the desired flux calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Calibrate Photometric Flux - Polarimetry" IDLFunc="apply_photometric_cal_polar" Comment=" Apply photometric calibration using satellite flux for polarimetry-mode data" Order=" 2.51" Type=" PolarimetricScience" Sequence=" " >
     <Argument  Name="FinalUnits" Type="int" Range="[0,10]" Default="1" Desc="0:Counts, 1:Counts/s, 2:ph/s/nm/m^2, 3:Jy, 4:W/m^2/um, 5:ergs/s/cm^2/A, 6:ergs/s/cm^2/Hz" />
     <Argument  Name="CalibrationFile" Type="fluxcal" Default="AUTOMATIC" Desc="Filename of the desired flux calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="calibrate with PSF" IDLFunc="calibrate_with_psf" Comment=" Create a few calibrations files based on the determination of a high resolution PSF." Order=" 4.01" Type=" Calibration" Sequence=" 22-" >
     <Argument  Name="filter_wavelength" Type="float" Range="[0.8,2.5]" Default="-1.0" Desc="Narrowband filter wavelength" />
     <Argument  Name="flat_field" Type="int" Range="[0,1]" Default="-1.0" Desc="Is this a flat field" />
     <Argument  Name="flat_filename" Type="string" Default="" Desc="Name of flat field" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Extract one spectrum" IDLFunc="extract_one_spectrum" Comment=" Extract one spectrum from a datacube somewhere in the FOV specified by the user." Order=" 2.51" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="xcenter" Type="int" Range="[0,1000]" Default="141" Desc="x-locations in pixel on datacube where extraction will be made" />
     <Argument  Name="ycenter" Type="int" Range="[0,1000]" Default="141" Desc="y-locations in pixel on datacube where extraction will be made" />
     <Argument  Name="radius" Type="float" Range="[0,1000]" Default="5." Desc="Aperture radius (in pixel i.e. mlens) to extract photometry for each wavelength. " />
     <Argument  Name="method" Type="string"  Default="total" Range="[median|mean|total]"  Desc="method of photometry extraction:median,mean,total" />
     <Argument  Name="ps_figure" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose # of saved fig suffix name, 0: no ps figure " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output (fits) on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Extract one spectrum, plots" IDLFunc="extract_one_spectrum2" Comment=" Extract one spectrum from a datacube somewhere in the FOV specified by the user." Order=" 2.51" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="xcenter" Type="int" Range="[0,1000]" Default="141" Desc="x-locations in pixel on datacube where extraction will be made" />
     <Argument  Name="ycenter" Type="int" Range="[0,1000]" Default="141" Desc="y-locations in pixel on datacube where extraction will be made" />
     <Argument  Name="radius" Type="float" Range="[0,1000]" Default="5." Desc="Aperture radius (in pixel i.e. mlens) to extract photometry for each wavelength. " />
     <Argument  Name="method" Type="string"  Default="total" Range="[median|mean|total]"  Desc="method of photometry extraction:median,mean,total" />
     <Argument  Name="ps_figure" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose # of saved fig suffix name, 0: no ps figure " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output (fits) on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-spec" Desc="Enter output suffix (fits)" />
 </Primitive>
 <Primitive Name="Measure telluric transmission" IDLFunc="extract_telluric_transmission" Comment=" Extract Telluric transmission from satelitte spots (method 1) or from PSF signal (method 2) using theoretical star spectrum. Correct or save the transmisssion." Order=" 2.5" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="method" Type="int" Range="[1,2]" Default="1" Desc="1: Use satellite flux. 2:Use clean PSF area." />
     <Argument  Name="Correct_datacube" Type="int" Range="[0,1]" Default="1" Desc="1: Correct datacube from extracted tell trams., 0: don't correct" />
     <Argument  Name="Save_corrected_datacube" Type="int" Range="[0,1]" Default="1" Desc="1: save corrected datacube on disk, 0: don't save" />
     <Argument  Name="Save_telluric_transmission" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-telcal" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Extract telluric transmission from sat. spots" IDLFunc="extract_telluric_transmission_meth1" Comment=" Extract Telluric Spectrum from satelitte spots" Order=" 2.51" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="Correct_datacube" Type="int" Range="[0,1]" Default="1" Desc="1: Correct datacube from extracted tell trams., 0: don't correct" />
     <Argument  Name="Save_corrected_datacube" Type="int" Range="[0,1]" Default="1" Desc="1: save corrected datacube on disk, 0: don't save" />
     <Argument  Name="Save_telluric_transmission" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-telcal" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="Xspot1" Type="int" Range="[0,2048]" Default="97" Desc="Initial approximate x-position [pixel] of sat. spot 1" />
     <Argument  Name="Yspot1" Type="int" Range="[0,2048]" Default="117" Desc="Initial approximate y-position [pixel] of sat. spot 1" />
     <Argument  Name="Xspot2" Type="int" Range="[0,2048]" Default="179" Desc="Initial approximate x-position [pixel] of sat. spot 2" />
     <Argument  Name="Yspot2" Type="int" Range="[0,2048]" Default="159" Desc="Initial approximate y-position [pixel] of sat. spot 2" />
 </Primitive>
 <Primitive Name="Extract telluric transmission from datacube" IDLFunc="extract_telluric_transmission_meth2" Comment=" Extract Telluric Spectrum from star spec estimated from datacube" Order=" 2.52" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="Correct_datacube" Type="int" Range="[0,1]" Default="1" Desc="1: Correct datacube from extracted tell trams., 0: don't correct" />
     <Argument  Name="Save_corrected_datacube" Type="int" Range="[0,1]" Default="1" Desc="1: save corrected datacube on disk, 0: don't save" />
     <Argument  Name="Save_telluric_transmission" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-telcal" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="Xspot1" Type="int" Range="[0,2048]" Default="97" Desc="Initial approximate x-position [pixel] of sat. spot 1" />
     <Argument  Name="Yspot1" Type="int" Range="[0,2048]" Default="117" Desc="Initial approximate y-position [pixel] of sat. spot 1" />
     <Argument  Name="Xspot2" Type="int" Range="[0,2048]" Default="179" Desc="Initial approximate x-position [pixel] of sat. spot 2" />
     <Argument  Name="Yspot2" Type="int" Range="[0,2048]" Default="159" Desc="Initial approximate y-position [pixel] of sat. spot 2" />
 </Primitive>
 <Primitive Name="Assemble Spectral Datacube (bp)" IDLFunc="extractcube_withbadpix" Comment=" Extract a 3D datacube from a 2D image taking account of the hot/cold pixel map (need to use also readbadpixmap with this primitive)." Order=" 2.0" Type=" SpectralScience" Sequence=" " >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-rawspdc" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Load Satellite Spot locations" IDLFunc="get_spots_locations" Comment=" Load satellite spot locations from calibration file " Order=" 2.45" Type=" Deprecated" Sequence="" >
     <Argument  Name="CalibrationFile" Type="spotloc" Default="AUTOMATIC" Desc="Filename of spot locations calibration file to be read" />
 </Primitive>
 <Primitive Name="Accumulate Images" IDLFunc="gpi_accumulate_images" Comment=" Stores images for combination by a subsequent primitive. Can buffer on disk for datasets too large to hold just in RAM." Order=" 4.0" Type=" ALL" Sequence=" " >
     <Argument  Name="Method" Type="string" Range="OnDisk|InMemory" Default="InMemory" Desc="OnDisk|InMemory" />
 </Primitive>
 <Primitive Name="Add Gemini and GPI keywords." IDLFunc="gpi_add_geminigpikeywords" Comment=" Add GPI and Gemini missing keywords. " Order=" 0.1" Type=" Testing" Sequence="" >
     <Argument  Name="overwrite" Type="int"  Default="0" Desc="0:do not overwrite already existent keyword; 1:overwrite" />
     <Argument  Name="exten" Type="int"  Default="0" Desc="Choose the extension num to place your keyword(s). 0 for FITS or MEF-PHU. 1 for extension1." />
     <Argument  Name="keyword1" Type="string"  Default="FILTER" Desc="Enter keyword name to add." />
     <Argument  Name="value1" Type="string"  Default="H" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword2" Type="string"  Default="OBSTYPE" Desc="Enter keyword name to add." />
     <Argument  Name="value2" Type="string"  Default="wavecal" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword3" Type="string"  Default="GCALLAMP" Desc="Enter keyword name to add." />
     <Argument  Name="value3" Type="string"  Default="Xenon" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword4" Type="string"  Default="PRISM" Desc="Enter keyword name to add." />
     <Argument  Name="value4" Type="string"  Default="Spectral" Desc="Enter value of the keyword to add." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-keyw" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Add missing keyword" IDLFunc="gpi_add_missingkeyword" Comment=" Add any missing keyword. (use this function several times in the DRF if you need to add more than one keyword)" Order=" 0.1" Type=" Calibration,Testing" Sequence="" >
     <Argument  Name="keyword" Type="string"  Default="" Desc="Enter keyword name to add." />
     <Argument  Name="value" Default="" Desc="Enter value of the keyword to add." />
 </Primitive>
 <Primitive Name="Add multi missing keywords." IDLFunc="gpi_add_multimissingkeyword" Comment=" Add any missing keyword. (use this function several times in the DRF if you need to add more than one keyword)" Order=" 0.1" Type=" Testing" Sequence="" >
     <Argument  Name="keyword1" Type="string"  Default="FILTER" Desc="Enter keyword name to add." />
     <Argument  Name="value1" Type=""  Default="H" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword2" Type="string"  Default="OBSTYPE" Desc="Enter keyword name to add." />
     <Argument  Name="value2" Type=""  Default="Xenon" Desc="Enter value of the keyword to add." />
 </Primitive>
 <Primitive Name="ADI with LOCI" IDLFunc="gpi_adi_with_loci" Comment=" Implements the LOCI ADI algorithm (Lafreniere et al. 2007)" Order=" 4.11" Type=" SpectralScience" Sequence="" >
     <Argument  Name="nfwhm" Type="float" Range="[0,20]" Default="1.5" Desc="number of FWHM to calculate the minimal distance for reference calculation" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Apply Reference Pixel Correction" IDLFunc="gpi_apply_reference_pixel_correction" Comment=" Subtract channel bias levels and bias drift stripes using H2RG reference pixels." Order=" 1.25" Type=" ALL" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display "  />
     <Argument  Name="before_and_after" Type="int" Range="[0,1]" Default="0" Desc="Show the before-and-after images for the user to see?" />
     <Argument  Name="Method" Type="enum" Range="SIMPLE_CHANNELS|INTERPOLATED"  Default="INTERPOLATED" Desc="Algorithm for reference pixel subtraction." />
 </Primitive>
 <Primitive Name="Assemble Datacube" IDLFunc="gpi_assemble_datacube" Comment=" Extract a 3D datacube from a 2D image (Calls assemble spectral or polarimetric cube automatically depending on input data format)" Order=" 2.0" Type=" Testing" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" />
 </Primitive>
 <Primitive Name="Assemble Polarization Cube" IDLFunc="gpi_assemble_polarization_cube" Comment=" Extract 2 perpendicular polarizations from a 2D image." Order=" 2.0" Type=" PolarimetricScience, Calibration" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Assemble Spectral Datacube" IDLFunc="gpi_assemble_spectral_datacube" Comment=" Assemble a 3D datacube from a 2D image. Spatial integration (3 pixels box) along the dispersion axis" Order=" 2.0" Type=" SpectralScience, Calibration" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Assemble Undispersed Image" IDLFunc="gpi_assemble_undispersed_image" Comment=" Extract a 2D image from a raw undispersed mode image. Box integration of the light from each lenslet." Order=" 2.0" Type=" Calibration" Sequence="" >
     <Argument  Name="xshift" Type="float" Range="[-100,100]" Default="-2.363" Desc="Shift in X direction" />
     <Argument  Name="yshift" Type="float" Range="[-100,100]" Default="-2.6134" Desc="Shift in Y direction" />
     <Argument  Name="boxsize" Type="float" Range="[0,10]" Default="5" Desc="Size of box to use for spectral extraction" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-extu" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Basic ADI" IDLFunc="gpi_basic_adi" Comment=" Implements the basic ADI algorithm described by Marois et al. (2006)." Order=" 4.1" Type=" SpectralScience" Sequence=" 02-03-" >
     <Argument  Name="numimmed" Type="int" Range="[1,100]" Default="3" Desc="number of images for the calculation of the PSF reference" />
     <Argument  Name="nfwhm" Type="float" Range="[0,20]" Default="1.5" Desc="number of FWHM to calculate the minimal distance for reference calculation" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Calibrate astrometry from binary (using 6th orbit catalog)" IDLFunc="gpi_calibrate_astrometry_from_binary_orbit_catalog" Comment=" Calculate astrometry from unocculted binaries; Calculate Separation and PA at date DATEOBS using the sixth orbit catalog." Order=" 2.61" Type=" Calibration" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Calibrate astrometry from binary (using separation and PA)" IDLFunc="gpi_calibrate_astrometry_from_binary_position" Comment=" Calculate astrometry from unocculted binaries using user-specified separation and PA at DATEOBS" Order=" 2.6" Type=" Calibration" Sequence="" >
     <Argument  Name="separation" Type="float" Range="[0.,4.]" Default="1." Desc="Separation [arcsec] at date DATEOBS of observation of the binaries" />
     <Argument  Name="pa" Type="float" Range="[0.,360.]" Default="4.8" Desc="Position angle [degree] at date DATEOBS of observation of the binaries" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Check for closed-loop coronagraphic image" IDLFunc="gpi_check_coronagraph_status" Comment="  Check whether file represents a closed-loop  coronagraphic image." Order=" 2.41" Type=" Calibration,SpectralScience,PolarimetricScience" Sequence="" >
     <Argument  Name="err_on_false" Type="int"  Range="[0,1]" Default="0" Desc=" If false, 0: continue to next image; 1: Throw error" />
 </Primitive>
 <Primitive Name="Check Data Quality" IDLFunc="gpi_check_data_quality" Comment=" Check quality of data based on header keywords. For bad data, can fail the reduction or simply alert the user." Order=" 0.9" Type=" ALL" Sequence="" >
     <Argument  Name="Action" Type="int" Range="[0,10]" Default="1" Desc="0:Simple alert and continue reduction, 1:Reduction fails" />
     <Argument  Name="r0" Type="float" Range="[0,2]" Default="0.08" Desc="critical r0 [m] at lambda=0.5microns" />
     <Argument  Name="rmserr" Type="float" Range="[0,1000]" Default="10." Desc="Critical rms wavefront error in microns. " />
 </Primitive>
 <Primitive Name="Clean Cosmic Rays" IDLFunc="gpi_clean_cosmic_rays" Comment=" Placeholder for cosmic ray rejection (if needed; not currently implemented!)" Order=" 1.23" Type=" ALL" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Collapse datacube" IDLFunc="gpi_collapse_datacube" Comment=" Collapse the wavelength dimension of a datacube via mean, median or total. " Order=" 2.6" Type=" ALL" Sequence=" " >
     <Argument  Name="Method" Type="enum" Range="MEDIAN|TOTAL"  Default="TOTAL" Desc="How to collapse datacube: total or median (with flux conservation)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="ReuseOutput" Type="int" Range="[0,1]" Default="1" Desc="1: keep output for following primitives, 0: don't keep" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 2D dark images" IDLFunc="gpi_combine_2d_dark_images" Comment=" Combine 2D dark images into a master file via mean or median. " Order=" 4.01" Type=" Calibration" Sequence=" 22-" >
     <Argument  Name="Method" Type="enum" Range="MEAN|MEDIAN|MEANCLIP"  Default="MEDIAN" Desc="How to combine images: median, mean, or mean with outlier rejection?[MEAN|MEDIAN]" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 2D images" IDLFunc="gpi_combine_2d_images" Comment=" Combine 2D images such as darks into a master file via mean or median. " Order=" 1.5" Type=" ALL" Sequence="" >
     <Argument  Name="Method" Type="enum" Range="MEAN|MEDIAN|MEANCLIP"  Default="MEDIAN" Desc="How to combine images: median, mean, or mean with outlier rejection?" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 2D Thermal/Sky Backgrounds" IDLFunc="gpi_combine_2d_thermal_sky_backgrounds" Comment=" Combine 2D images with measurement of thermal or sky background" Order=" 1.51" Type=" Calibration" Sequence="" >
     <Argument  Name="Method" Type="enum" Range="MEAN|MEDIAN"  Default="MEDIAN" Desc="How to combine images: median, mean, or mean with outlier rejection?" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 3D Datacubes" IDLFunc="gpi_combine_3d_datacubes" Comment=" Combine 3D datacubes via mean or median. " Order=" 4.5" Type=" ALL" Sequence="" >
     <Argument  Name="Method" Type="enum" Range="MEAN|MEDIAN|MEANCLIP|MINIMUM"  Default="MEDIAN" Desc="How to combine images: median, mean, or mean with outlier rejection?" />
     <Argument  Name="sig_clip" Type="int" Range="0,10" Default="3" Desc="Clipping value to be used with MEANCLIP in sigma (stddev)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Polarization Sequence" IDLFunc="gpi_combine_polarization_sequence" Comment="" Order=" 4.4" Type=" PolarimetricScience,Calibration" Sequence=" 11-" >
     <Argument  Name="HWPoffset" Type="float" Range="[-360.,360.]" Default="-29.14" Desc="The internal offset of the HWP. If unknown set to 0" />
     <Argument  Name="IncludeSystemMueller" Type="int" Range="[0,1]" Default="1" Desc="1: Include, 0: Don't" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Wavelength Calibrations locations" IDLFunc="gpi_combine_wavcal_locations_all" Comment=" Combine wavelength calibration from  flat and arc" Order=" 4.2" Type=" Calibration" Sequence=" 23-" >
     <Argument  Name="polydegree" Type="int" Range="[1,2]" Default="1" Desc="1: linear wavelength solution, 2: quadratic wav. sol." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Wavelength Calibrations" IDLFunc="gpi_combine_wavelength_calibrations" Comment=" Performs simple median combination of wavelength calibrations from flat and/or arc lamps" Order=" 4.2" Type=" Calibration" Sequence=" 23-" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Copy keyword value to an other keyword." IDLFunc="gpi_copykeywordvalue" Comment=" Copy keyword values to other keywords. " Order=" 0.12" Type=" Testing" Sequence="" >
     <Argument  Name="overwrite" Type="int"  Default="0" Desc="0:do not overwrite already existent keyword; 1:overwrite" />
     <Argument  Name="keyw_source_1" Type="string"  Default="OBJECT" Desc="Enter keyword name to copy its value to keyw_target_1." />
     <Argument  Name="keyw_target_1" Type="string"  Default="GCALLAMP" Desc="Enter keyword name that will receive value of keyw_source_1." />
     <Argument  Name="keyw_source_2" Type="string"  Default="OBJECT" Desc="Enter keyword name to copy its value to keyw_target_2." />
     <Argument  Name="keyw_target_2" Type="string"  Default="GCALSHUT" Desc="Enter keyword name that will receive value of keyw_source_2." />
     <Argument  Name="keyw_source_3" Type="string"  Default="OBJECT" Desc="Enter keyword name to copy its value to keyw_target_2." />
     <Argument  Name="keyw_target_3" Type="string"  Default="OBSTYPE" Desc="Enter keyword name that will receive value of keyw_source_2." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-keyw" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Correct Distortion" IDLFunc="gpi_correct_distortion" Comment=" Correct GPI distortion" Order=" 2.44" Type=" SpectralScience,PolarimetricScience" Sequence=" " >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="CalibrationFile" Type="distorcal" Default="AUTOMATIC" Desc="Filename of the desired distortion calibration file to be read" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create 2D Low Frequency Flat" IDLFunc="gpi_create_2d_low_frequency_flat" Comment=" Create Low Frequency Flat 2D from polarimetry flats" Order=" 4.01" Type=" HIDDEN" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create Bad Pixel Map from text list of pixels" IDLFunc="gpi_create_bad_pixel_map_from_list" Comment=" Generate FITS bad pixel map from an ASCII text list of pixel coords X, Y" Order=" 4.01" Type=" Testing" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="bptype" Type="string" Range="hotbadpix|coldbadpix|nonlinearbadpix" Default="coldbadpix" Desc="Type of bad pixel mask to write" />
     <Argument  Name="CalibrationFile" Type="string" Default="AUTOMATIC" Desc="Input ASCII pixel list file" />
 </Primitive>
 <Primitive Name="Create microphonics noise model" IDLFunc="gpi_create_microphonics_noise_model" Comment=" Create a microphonics noise model in Fourier space." Order=" 4.01" Type=" Calibration" Sequence=" 22-" >
     <Argument  Name="Gauss_Interp" Type="int" Range="[0,1]" Default="0" Desc="1: Interpolate each peak by a 2d gaussian, 0: don't interpolate" />
     <Argument  Name="Combining_Method" Type="string" Range="ADD|MEDIAN" Default="ADD" Desc="Method to combine the Fourier transforms of the microphonics (ADD|MEDIAN)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create Symbolic Links" IDLFunc="gpi_create_symlinks" Comment=" Create symbolic links on the file system for files either input to or output from the data pipeline." Order=" 5.0" Type=" Testing" Sequence="" >
     <Argument  Name="filetolink" Type="string" Default="INPUT_FILE" Desc="File to create a link for. Either 'INPUT_FILE', 'LAST_OUTPUT_FILE', or the specific filename of some existing disk file" />
     <Argument  Name="createlinkdir" Type="string" Default="${GPI_REDUCED_DATA_DIR}" Desc="Directory to create a link in. Must be a directory, not any other filename." />
     <Argument  Name="appenddatedir" Type="int" Range="[0,1]" Default="1" Desc="Append the YYMMDD date string to createlinkdir" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Destripe for Darks Only" IDLFunc="gpi_destripe_for_darks_only" Comment=" Subtract readout pickup noise using median across all channels. This is an aggressive destriping algorithm suitable only for use on images that have no light. Also includes microphonics noise removal." Order=" 1.3" Type=" Calibration" Sequence="" >
     <Argument  Name="remove_microphonics" Type="string" Range="[yes|no]" Default="yes" Desc='Attempt to remove microphonics noise via Fourier filtering?' />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window else = Window number to display diagonostics in." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display "  />
 </Primitive>
 <Primitive Name="Destripe science image" IDLFunc="gpi_destripe_science_image" Comment="  Subtract detector striping using measurements between the microspectra" Order=" 1.3" Type=" SpectralScience,Calibration, PolarimetricScience" Sequence="" >
     <Argument  Name="method" Type="string" Range="[threshhold|calfile]" Default="calfile" Desc='Find background based on image value threshhold cut, or calibration file spectra/spot locations?' />
     <Argument  Name="abort_fraction" Type="float" Range="[0.0,1.0]" Default="0.9" Desc="Necessary fraction of pixels in mask to continue - set at 0.9 to ensure quicklook tool is robust" />
     <Argument  Name="chan_offset_correction" Type="int" Range="[0,1]" Default="0" Desc="Tries to correct for channel bias offsets - useful when no dark is available" />
     <Argument  Name="fraction" Type="float" Range="[0.0,1.0]" Default="0.7" Desc="What fraction of the total pixels in a row should be masked" />
     <Argument  Name="high_limit" Type="float" Range="[0,Inf]" Default="1" Desc="Pixel value where exceeding values are assigned a larger mask" />
     <Argument  Name="Save_stripes" Type="int" Range="[0,1]" Default="0" Desc="Save the striping noise image subtracted from frame?" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window else = Window number to display diagonostics in." />
     <Argument  Name="remove_microphonics" Type="int" Range="[0,2]" Default="0" Desc='Remove microphonics noise based on a precomputed fixed model.0: not applied. 1: applied. 2: the algoritm is applied only if the measured noise is greater than micro_threshold' />
     <Argument  Name="method_microphonics" Type="int" Range="[1,3]" Default="0" Desc='Method applied for microphonics 1: model projection. 2: all to zero 3: gaussian fit' />
     <Argument  Name="CalibrationFile" Type="micro" Default="AUTOMATIC" Desc="Filename of the desired microphonics model file to be read" />
     <Argument  Name="Plot_micro_peaks" Type="string" Range="[yes|no]" Default="no" Desc="Plot in 3d the peaks corresponding to the microphonics" />
     <Argument  Name="save_microphonics" Type="string" Range="[yes|no]" Default="no" Desc='If remove_microphonics = 1 or (auto and micro_threshold overpassed), save the removed microphonics' />
     <Argument  Name="micro_threshold" Type="float" Range="[0.0,1.0]" Default="0.01" Desc='If remove_microphonics = 2, set the threshold. This value is sum(abs(fft(image))*abs(fft(noise_model)))/sqrt(sum(image^2))' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: Save output to disk, 0: Don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Display raw image with GPItv" IDLFunc="gpi_display_raw_image_with_gpitv" Comment=" Display, with GPItv, raw data to be processed  " Order=" 0.01" Type=" ALL, HIDDEN" Sequence="" >
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0 for no display " />
 </Primitive>
 <Primitive Name="Divide by Polarized Flat Field" IDLFunc="gpi_divide_by_polarized_flat_field" Comment=" Divides a 2-slice polarimetry file by a flat field." Order=" 3.5" Type=" PolarimetricScience, Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" Type="polflat" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Divide by Spectral Flat Field" IDLFunc="gpi_divide_by_spectral_flat_field" Comment=" Divides a spectral data-cube by a flat field data-cube." Order=" 2.2" Type=" SpectralScience,Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" Type="specflat" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Divide by Telluric Transmission" IDLFunc="gpi_divide_by_telluric_transmission" Comment=" Divides a spectral data-cube by a telluric transmission calibration file." Order=" 2.5" Type=" SpectralScience,Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" Type="-tellucal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Measure locations of Emission Lines" IDLFunc="gpi_extract_wavcal_locations" Comment=" Derive wavelength calibration from an arc lamp or flat-field image." Order=" 1.73" Type=" Calibration" Sequence="" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.8" Desc="Spectral spacing perpendicular to the dispersion axis at the detcetor in pixel" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="-1.8" Desc="Micro-pupil pattern" />
     <Argument  Name="wav_of_centrXYpos" Type="int" Range="[1,2]" Default="2" Desc="1 if centrX-Ypos is the smallest-wavelength peak of the band; 2 if centrX-Ypos refer to 1.5microns" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2." Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="maxtilt" Type="float" Range="[-360.,360.]" Default="10." Desc="Allowed maximum tilt fluctuation (in degree) between adjacent mlens" />
     <Argument  Name="medfilter" Type="int" Range="[0,1]" Default="1" Desc="1: Median filtering of dispersion coeff and tilts with a (5x5) median filtering" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
     <Argument  Name="tests" Type="int" Range="[0,3]" Default="0" Desc="1 for extensive tests " />
 </Primitive>
 <Primitive Name="Assemble Spectral Datacube using mlens PSF" IDLFunc="gpi_extractcube_mlenspsf" Comment=" Extract a 3D datacube from a 2D image. Spatial integration (3 pixels) along the dispersion axis" Order=" 2.0" Type="" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="CalibrationFile" Type="mlenspsf" Default="AUTOMATIC" Desc="Filename of the mlens-PSF calibration file to be read" />
     <Argument  Name="ReuseOutput" Type="int" Range="[0,1]" Default="0" Desc="1: keep output for following primitives, 0: don't keep" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Find Cold Bad Pixels from Flats" IDLFunc="gpi_find_cold_bad_pixels_from_flats" Comment=" Find cold pixels from a stack of flat images using all different filters" Order=" 4.01" Type=" Calibration" Sequence=" 22-" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Find Hot Bad Pixels from Darks" IDLFunc="gpi_find_hot_bad_pixels_from_darks" Comment=" Find hot pixels from a stack of dark images (best with deep integration darks)" Order=" 4.01" Type=" Calibration" Sequence=" 22-" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Generate Combined Bad Pixel Map" IDLFunc="gpi_generate_combined_bad_pixel_map" Comment=" This routine combines various sub-types of bad pixel mask (hot, cold,  anomalous nonlinear pixels) to generate a master bad pixel list." Order=" 4.02" Type=" Calibration" Sequence=" " >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Insert Planet into datacube" IDLFunc="gpi_insert_planet_into_cube" Comment=" This primitive inserts planets into reduced datacubes. It can be run multiple times to insert multiple planets. " Order=" 5.0" Type=" SpectralScience" Sequence="" >
     <Argument  Name="Age" Type="int" Range="[1,1000]"  Default="10" Desc="Age of planet in Myr" />
     <Argument  Name="Mass" Type="int" Range="[1,15]"  Default="10" Desc="Mass of planet in Jupiter masses" />
     <Argument  Name="model_type" Type="string" Range="[hot,cold]"  Default="hot" Desc="Hot or Cold Start formation scenario" />
     <Argument  Name="Position_angle" Type="float" Range="[0,360]"  Default="45.0" Desc="Position angle of the planet in degrees East of North" />
     <Argument  Name="Separation" Type="float" Range="[0,1400]"  Default="500" Desc="Separation in milli-arcseconds" />
     <Argument  Name="Star_Mag" Type="float" Range="[-1,8]"  Default="-1" Desc="Stellar Magnitude in H band, -1 estimates stellar magnitude from satellite spots" />
     <Argument  Name="distance" Type="float" Range="[0-1000]"  Default="10.0" Desc="distance to system in parsecs" />
     <Argument  Name="write_header_info" Type="int" Range="[0,1]" Default="1" Desc="1: Write planet info to headers 0: don't write planet info to headers" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Interpolate bad pixels in 2D frame" IDLFunc="gpi_interpolate_bad_pixels_in_2d_frame" Comment="  Repair bad pixels by interpolating between their neighbors. Can optionally just flag as NaNs or else interpolate." Order=" 1.4 " Type=" SpectralScience, PolarimetricScience, Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" type="filename" default="AUTOMATIC" Desc="Filename of the desired bad pixel file to be read" />
     <Argument  Name="method" Type="string" Range="[n4n|vertical|all8]" Default="vertical" Desc='Repair bad bix interpolating all 8 neighboring pixels, or just the 2 vertical ones, or just flag as NaN (n4n)?' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="before_and_after" Type="int" Range="[0,1]" Default="0" Desc="Show the before-and-after images for the user to see? (for debugging/testing)" />
 </Primitive>
 <Primitive Name="Interpolate Wavelength Axis" IDLFunc="gpi_interpolate_wavelength_axis" Comment=" Interpolate spectral datacube onto regular wavelength sampling." Order=" 2.3" Type=" SpectralScience,Calibration" Sequence="" >
     <Argument  Name="Spectralchannels" Type="int" Range="[0,100]" Default="37" Desc="Choose how many spectral channels for output datacube" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="KLIP algorithm Angular Differential Imaging" IDLFunc="gpi_klip_algorithm_angular_differential_imaging" Comment=" Reduce speckle noise using the KLIP algorithm with ADI data" Order=" 2.8" Type=" SpectralScience" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="0" Desc="Number of annuli used" />
     <Argument  Name="MinRotation" Type="float" Range="[0.0,360.0]" Default="1" Desc="Minimum rotation between images (degrees)" />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="KLIP algorithm Spectral Differential Imaging" IDLFunc="gpi_klip_algorithm_spectral_differential_imaging" Comment=" Reduce speckle noise using the KLIP algorithm across the spectral axis of a datacube." Order=" 2.8" Type=" SpectralScience" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="refslice" Type="int" Range="[0,100]" Default="0" Desc="Slice of the reference PSF" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="5" Desc="Number of annuli used" />
     <Argument  Name="movement" Type="float" Range="[0.0,5.0]" Default="2.0" Desc="Minimum pixel movement for reference set" />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="arcsec" Type="float" Range="[0.0,1.0]" Default=".4" Desc="Radius of interest if using 1 annulus" />
     <Argument  Name="signal" Type="int" Range="[0,1]" Default="0" Desc="1: calculate signal to noise ration, 0: don't calculate" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Load Instrumental Polarization Calibration" IDLFunc="gpi_load_instrumental_polarization_calibration" Comment=" Load a calibration file for the instrumental polarization." Order=" 0.52" Type=" PolarimetricScience,Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" Type="instpol" Default="AUTOMATIC" Desc="Filename of the desired instrumental polarization file to be read"  />
 </Primitive>
 <Primitive Name="Load Polarimetry Spot Calibration" IDLFunc="gpi_load_polarimetry_spot_calibration" Comment=" Reads a pol spot calibration file from disk. This primitive is required for any polarimetry data-cube extraction." Order=" 0.51" Type=" PolarimetricScience,Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" Type="polcal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
 </Primitive>
 <Primitive Name="Load Wavelength Calibration" IDLFunc="gpi_load_wavelength_calibration" Comment=" Reads a wavelength calibration file from disk. This primitive is required for any data-cube extraction." Order=" 0.5" Type=" SpectralScience,Calibration" Sequence="" >
     <Argument  Name="CalibrationFile" Type="wavcal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
 </Primitive>
 <Primitive Name="Plot the satellite spot locations vs. the expected location from wavelength scaling" IDLFunc="gpi_meas_satspot_dev" Comment=" Measured vs. wavelength scaled sat spot locations" Order=" 2.7" Type=" SpectralScience,PolarimetricScience" Sequence="" >
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display in." />
     <Argument  Name="SaveData" Type="string" Default="" Desc="Save data to filename (blank for no save)" />
     <Argument  Name="SavePNG" Type="string" Default="" Desc="Save plot to filename as PNG(blank for no save)" />
 </Primitive>
 <Primitive Name="Measure Contrast" IDLFunc="gpi_measure_contrast" Comment=" Measure the contrast. Save as PNG or FITS table." Order=" 2.7" Type=" SpectralScience,PolarimetricScience" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display in." />
     <Argument  Name="SaveProfile" Type="string" Default="" Desc="Save radial profile to filename as FITS (blank for no save, dir name for default naming, AUTO for auto full path)" />
     <Argument  Name="SavePNG" Type="string" Default="" Desc="Save plot to filename as PNG (blank for no save, dir name for default naming, AUTO for auto full path) " />
     <Argument  Name="contrsigma" Type="float" Range="[0.,20.]" Default="5." Desc="Contrast sigma limit" />
     <Argument  Name="slice" Type="int" Range="[-1,50]" Default="0" Desc="Slice to plot. -1 for all" />
     <Argument  Name="DarkHoleOnly" Type="int" Range="[0,1]" Default="1" Desc="0: Plot profile in dark hole only; 1: Plot outer profile as well." />
     <Argument  Name="contr_yunit" Type="int" Range="[0,2]" Default="0" Desc="0: Standard deviation; 1: Median; 2: Mean." />
     <Argument  Name="contr_xunit" Type="int" Range="[0,1]" Default="0" Desc="0: Arcsec; 1: lambda/D." />
     <Argument  Name="yscale" Type="int" Range="[0,1]" Default="0" Desc="0: Auto y axis scaling; 1: Manual scaling." />
     <Argument  Name="contr_yaxis_type" Type="int" Range="[0,1]" Default="1" Desc="0: Linear; 1: Log" />
     <Argument  Name="contr_yaxis_min" Type="float" Range="[0.,1.]" Default="0.00000001" Desc="Y axis minimum" />
     <Argument  Name="contr_yaxis_max" Type="float" Range="[0.,1.]" Default="1." Desc="Y axis maximum" />
 </Primitive>
 <Primitive Name="Measure GPI distortion from grid pattern" IDLFunc="gpi_measure_distortion" Comment=" Measure GPI distortion from grid pattern" Order=" 2.44" Type=" Calibration" Sequence=" " >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Measure Polarization Spot Calibration" IDLFunc="gpi_measure_polarization_spot_calibration" Comment=" Derive polarization calibration files from a flat field image." Order=" 1.8" Type=" Calibration" Sequence="" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.4" Desc="Spectral spacing perpendicular to the dispersion axis at the detcetor in pixel" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="2.18" Desc="Micro-pupil pattern" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2.5" Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="FitWidth" Type="float" Range="[-10.,10.]" Default="3" Desc="Size of box around a spot used to find center" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" />
     <Argument  Name="Display" Type="int" Range="[0,1]" Default="1" />
 </Primitive>
 <Primitive Name="Measure satellite spot locations" IDLFunc="gpi_measure_satellite_spot_locations" Comment=" Measure the locations of the satellite spots in the datacube, and save the results to the FITS keyword headers." Order=" 2.44" Type=" Calibration,SpectralScience" Sequence="" >
     <Argument  Name="refine_fits" Type="int" Range="[0,1]" Default="1" Desc="0: Use wavelength scaling only; 1: Fit each slice" />
     <Argument  Name="reference_index" Type="int" Range="[0,50]" Default="0" Desc="Index of slice to use for initial satellite detection." />
     <Argument  Name="search_window" Type="int" Range="[1,50]" Default="20" Desc="Radius of aperture used for locating satellite spots." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="loc_input" Type="int" Range="[0,2]" Default="0" Desc="0: Find spots automatically; 1: Use values below as initial satellite spot location" />
     <Argument  Name="x1" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of top left spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y1" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of top left spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="x2" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of bottom left spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y2" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of bottom left spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="x3" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of top right spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y3" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of top right spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="x4" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of bottom right spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y4" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of bottom right spot on central slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
 </Primitive>
 <Primitive Name="Measure satellite spot peak fluxes" IDLFunc="gpi_measure_satellite_spot_peak_fluxes" Comment=" Calculate peak fluxes of satellite spots in datacubes " Order=" 2.45" Type=" Calibration,SpectralScience" Sequence="" >
     <Argument  Name="gauss_fit" Type="int" Range="[0,1]" Default="1" Desc="0: Extract maximum pixel; 1: Correlate with Gaussian to find peak" />
     <Argument  Name="reference_index" Type="int" Range="[0,50]" Default="0" Desc="Index of slice to use for initial satellite detection." />
     <Argument  Name="ap_rad" Type="int" Range="[1,50]" Default="7" Desc="Radius of aperture used for finding peaks." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Measure Wavelength Calibration" IDLFunc="gpi_measure_wavelength_calibration" Comment=" Derive wavelength calibration from an arc lamp or flat-field image." Order=" 1.7" Type=" Calibration" Sequence=" " >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.8" Desc="Spectral spacing perpendicular to the dispersion axis at the image center [pixel]" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="-1.8" Desc="Ratio of spectral offset parallel to dispersion over spectral spacing perpendicular to dispersion" />
     <Argument  Name="emissionlinesfile" Type="string"  Default="AUTOMATIC" Desc="File of emission lines." />
     <Argument  Name="wav_of_centrXYpos" Type="int" Range="[1,2]" Default="2" Desc="1 if centrX-Ypos is the smallest-wavelength peak of the band; 2 if centrX-Ypos refer to 1.5microns" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2." Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="maxtilt" Type="float" Range="[-360.,360.]" Default="10." Desc="Allowed maximum tilt fluctuation (in degree) between adjacent mlens" />
     <Argument  Name="centroidmethod" Type="int" Range="[0,1]" Default="0" Desc="Centroid method: 0 means barycentric (fast), 1 means gaussian fit (slow)" />
     <Argument  Name="medfilter" Type="int" Range="[0,1]" Default="1" Desc="1: Median filtering of dispersion coeff and tilts with a (5x5) median filtering" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="iscalib" Type="int" Range="[0,1]" Default="1" Desc="1: save to Calibrations Database, 0: save in regular reduced data dir" />
     <Argument  Name="lamp_override" Type="int" Range="[0,1]" Default="0" Desc="0,1: override the filter/lamp combinations?" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
     <Argument  Name="tests" Type="int" Range="[0,3]" Default="0" Desc="1 for extensive tests " />
     <Argument  Name="testsDST" Type="int" Range="[0,3]" Default="0" Desc="1 for DST tests " />
 </Primitive>
 <Primitive Name="Median Combine ADI datacubes" IDLFunc="gpi_median_combine_adi_datacubes" Comment=" Median combine all residual datacubes after an ADI (or LOCI) speckle suppression." Order=" 4.5" Type=" SpectralScience" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Noise and Flux Analysis" IDLFunc="gpi_noise_and_flux_analysis" Comment=" Store a few key values as fits keywords in the file. It can generate anciliary files too." Order=" 2.1" Type=" HIDDEN" Sequence="" >
     <Argument  Name="Flux" Type="int" Range="[0,1]" Default="1" Desc='Trigger flux analysis' />
     <Argument  Name="StddevMed" Type="int" Range="[0,2]" Default="1" Desc='Trigger the standard deviation (and median) analysis of the image. if StddevMed=1, only keywords and log are produced. If StddevMed=2, fits files are generated with a sliding median and standard deviation.' />
     <Argument  Name="Width" Type="int" Range="[3,2048]" Default="101" Desc='If Stddev = 2, Width of the moving rectangle. It has to be odd.' />
     <Argument  Name="PixelsSkipped" Type="int" Range="[0,2047]" Default="100" Desc='If Stddev = 2, Pixels skipped between two points' />
     <Argument  Name="MicroNoise" Type="int" Range="[0,1]" Default="1" Desc='Trigger the microphonics noise analysis' />
     <Argument  Name="CalibrationFile" Type="string" Default="AUTOMATIC" Desc="Filename of the desired microphonics model file to be read" />
     <Argument  Name="FourierTransf" Type="int" Range="[0,1,2]" Default="1" Desc='1: frequency 0 on the bottom left. 2: frequencies 0 will be centered on the image.' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Normalize polarimetry flat field" IDLFunc="gpi_normalize_polarimetry_flat_field" Comment=" Normalize a polarimetry-mode flat field to unity." Order=" 3.1992" Type=" Calibration" Sequence=" 31-" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Parallelized Polarization Spot Calibration" IDLFunc="gpi_parallelized_polarization_spot_calibration" Comment=" Derive polarization calibration files from a flat field image." Order=" 1.8" Type=" Testing" Sequence="" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.8" Desc="Spectral spacing perpendicular to the dispersion axis at the detcetor in pixel" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="-1.8" Desc="Micro-pupil pattern" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2.5" Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="FitWidth" Type="float" Range="[-10.,10.]" Default="3" Desc="Size of box around a spot used to find center" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" />
     <Argument  Name="Display" Type="int" Range="[0,1]" Default="1" />
 </Primitive>
 <Primitive Name="Populate Flexure Shifts vs Elevation Table" IDLFunc="gpi_populate_flexure_shifts_vs_elevation_table" Comment=" Derive shifts vs elevation lookup table." Order=" 4.2" Type=" Calibration" Sequence="" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="1" Desc="-1 = No display; 0 = New (unused) window else = Window number to display diagnostic plot in." />
     <Argument  Name="saveplots" Type="string" Range="[yes|no]" Default="no" Desc='Save diagnostic plots to PS files after running? [yes|no]' />
 </Primitive>
 <Primitive Name="Quick Wavelength Solution Update" IDLFunc="gpi_quick_wavelength_solution_update" Comment=" Given an existing wavecal and a new Xe lamp image, this primitive updates the wavecal roughly based on the X,Y positions measured for a subset of the Xe spectra. " Order=" 1.7" Type=" Calibration" Sequence="" >
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display each lenslet in comparison to the detector lenslet in." />
     <Argument  Name="spacing" Type="Int" Range="[0,20]" Default="10" Desc="Test every Nth lenslet for this value of N." />
     <Argument  Name="boxsizex" Type="Int" Range="[0,15]" Default="7" Desc="x dimension of a lenslet cutout" />
     <Argument  Name="boxsizey" Type="Int" Range="[0,50]" Default="24" Desc="y dimension of a lenslet cutout" />
     <Argument  Name="whichpsf" Type="Int" Range="[0,1]" Default="0" Desc="Type of psf 0;gaussian, 1;microlens" />
     <Argument  Name="CalibrationFile" Type="wavcal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
 </Primitive>
 <Primitive Name="Remove Flat Lamp spectrum" IDLFunc="gpi_remove_flat_lamp_spectrum" Comment=" Fit the lamp spectrum and remove it (for delivering flat field cubes)" Order=" 2.25" Type=" Calibration" Sequence=" 21-" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="method" Type="string" Range="polyfit|linfit|blackbody|none" Default="blackbody" Desc="Method to use for removing lamp spectrum" />
 </Primitive>
 <Primitive Name="Remove Persistence from Previous Images" IDLFunc="gpi_remove_persistence_from_previous_images" Comment=" Determines/Removes persistence of previous images" Order=" 1.2" Type=" ALL" Sequence=" 3-" >
     <Argument  Name="CalibrationFile" Type="persis" Default="AUTOMATIC" Desc="Filename of the persistence_parameter file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display "  />
 </Primitive>
 <Primitive Name="Rotate 2D image" IDLFunc="gpi_rotate_2d_image" Comment=" Rotate a 2d image by some multiple of 90 degrees " Order=" 1.9" Type=" Testing" Sequence="" >
     <Argument  Name="Direction" Type="int" Range="[0,3]" Default="1" Desc="Rotation Counterclockwise:0=None,1=90deg,2=180deg,3=270deg" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Rotate extended object" IDLFunc="gpi_rotate_extended_object_with_pa" Comment=" Rotate extended object using parallactic angle for spectroscopic obs." Order=" 4.1" Type=" Deprecated" Sequence=" 02-03-" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Rotate Field of View Square" IDLFunc="gpi_rotate_field_of_view_square" Comment=" Rotate datacubes so that the field of view is squarely aligned with the image axes. " Order=" 3.9" Type=" SpectralScience,PolarimetricScience" Sequence=" 11-" >
     <Argument  Name="Method" Type="enum" Range="CUBIC|FFT" Default="CUBIC" />
     <Argument  Name="crop" Type="int" Range="[0,1]" Default="0" Desc="Set to 1 to crop out non-illuminated pixels" />
     <Argument  Name="Show" Type="int" Range="[0,1]" Default="0" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Rotate North Up" IDLFunc="gpi_rotate_north_up" Comment=" Rotate datacubes so that north is up. " Order=" 3.9" Type=" SpectralScience,PolarimetricScience" Sequence="" >
     <Argument  Name="Method" Type="enum" Range="CUBIC|FFT" Default="CUBIC" />
     <Argument  Name="Show" Type="enum" Range="0|1" Default="0" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Save Output" IDLFunc="gpi_save_output" Comment=" Save output to disk as a FITS file. Note that you can often do this from another module by setting the 'save=1' option; this is a redundant way to specify that. " Order=" 10.0" Type=" ALL" Sequence="" >
     <Argument  Name='suffix' type='string' default='default' Desc="choose the suffix" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Shift 2D Image" IDLFunc="gpi_shift_2d_image" Comment=" Shift 2D image, by integer or fractional pixel amounts.  Doesn't shift ref pixels. " Order=" 1.9" Type=" Testing,Calibration" Sequence="" >
     <Argument  Name="dx" Type="float" Range="[-10,10]" Default="0" Desc="shift amount in X direction" />
     <Argument  Name="dy" Type="float" Range="[-10,10]" Default="0" Desc="shift amount in Y direction" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Simple SDI of post ADI residual" IDLFunc="gpi_simple_sdi_of_post_adi_residual" Comment=" Apply SSDI to create a 2D subtracted image from a cube. Given the user's specified wavelength ranges, extract the 3D datacube slices for each of those wavelength ranges. Collapse these down into 2D images by simply averaging the values at each lenslet (ignoring NANs).  Rescale Image1, then compute  diffImage = I1scaled - k* I2" Order=" 4.3" Type=" SpectralScience" Sequence="" >
     <Argument  Name="L1Min" Type="float" Range="[0.9,2.5]" Default="1.55" Desc="Wavelength range 1, minimum wavelength [in microns]" />
     <Argument  Name="L1Max" Type="float" Range="[0.9,2.5]" Default="1.57" Desc="Wavelength range 1, maximum wavelength [in microns]" />
     <Argument  Name="L2Min" Type="float" Range="[0.9,2.5]" Default="1.60" Desc="Wavelength range 2, minimum wavelength [in microns]" />
     <Argument  Name="L2Max" Type="float" Range="[0.9,2.5]" Default="1.65" Desc="Wavelength range 2, maximum wavelength [in microns]" />
     <Argument  Name="k" Type="float" Range="[0,10]" Default="1.0" Desc="Scaling factor of Intensity(wav_range2) with diffImage = I1scaled - k* I2" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Simple Spectral Differential Imaging" IDLFunc="gpi_simple_spectral_differential_imaging" Comment=" Apply SSDI to create a 2D subtracted image from a cube. Given the user's specified wavelength ranges, extract the 3D datacube slices for each of those wavelength ranges. Collapse these down into 2D images by simply averaging the values at each lenslet (ignoring NANs).  Rescale Image1, then compute  diffImage = I1scaled - k* I2" Order=" 2.61" Type=" SpectralScience" Sequence="" >
     <Argument  Name="L1Min" Type="float" Range="[0.9,2.5]" Default="1.55" Desc="Wavelength range 1, minimum wavelength [in microns]" />
     <Argument  Name="L1Max" Type="float" Range="[0.9,2.5]" Default="1.57" Desc="Wavelength range 1, maximum wavelength [in microns]" />
     <Argument  Name="L2Min" Type="float" Range="[0.9,2.5]" Default="1.60" Desc="Wavelength range 2, minimum wavelength [in microns]" />
     <Argument  Name="L2Max" Type="float" Range="[0.9,2.5]" Default="1.65" Desc="Wavelength range 2, maximum wavelength [in microns]" />
     <Argument  Name="k" Type="float" Range="[0,10]" Default="1.0" Desc="Scaling factor of Intensity(wav_range2) with diffImage = I1scaled - k* I2" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="ReuseOutput" Type="int" Range="[0,1]" Default="1" Desc="1: keep output for following primitives, 0: don't keep" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Speckle alignment" IDLFunc="gpi_speckle_alignment" Comment=" This recipe rescales datacube PSF slices with respect to a chosen reference PSF slice." Order=" 2.61" Type=" SpectralScience" Sequence="" >
     <Argument  Name="k" Type="int" Range="[0,100]" Default="0" Desc="Slice of the reference PSF" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract background from 2D image" IDLFunc="gpi_subtract_background_from_2d_image" Comment="  Subtract 2D background based on the regions in between the spectra" Order=" 1.12 " Type=" Testing" Sequence="" >
     <Argument  Name="method" Type="string" Range="[threshhold|calfile]" Default="calfile" Desc='Find background based on image value threshhold cut, or calibration file spectra/spot locations?' />
     <Argument  Name="abort_fraction" Type="float" Range="[0.0,1.0]" Default="0.9" Desc="Necessary fraction of pixels in mask to continue - set at 0.9 to ensure quicklook tool is robust" />
     <Argument  Name="chan_offset_correction" Type="int" Range="[0,1]" Default="0" Desc="Tries to correct for channel bias offsets - useful when no dark is available" />
     <Argument  Name="fraction" Type="float" Range="[0.0,1.0]" Default="0.7" Desc="What fraction of the total pixels in a row should be masked" />
     <Argument  Name="high_limit" Type="float" Range="[0,Inf]" Default="1" Desc="Pixel value where exceeding values are assigned a larger mask" />
     <Argument  Name="Save_stripes" Type="int" Range="[0,1]" Default="0" Desc="Save the striping noise image subtracted from frame?" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: Save output to disk, 0: Don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract Dark Background" IDLFunc="gpi_subtract_dark_background" Comment=" Subtract a dark frame. " Order=" 1.1" Type=" ALL" Sequence="" >
     <Argument  Name="CalibrationFile" Type="filename" Default="AUTOMATIC" Desc="Name of dark file to subtract" />
     <Argument  Name="RequireExactMatch" Type="int" Range="[0,1]" Default="0" Desc="Must dark calibration file exactly match in integration time, or is scaling from a different exposure time allowed?" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract Thermal/Sky Background if K band" IDLFunc="gpi_subtract_thermal_sky_background_if_k_band" Comment=" Subtract a dark frame. " Order=" 1.2" Type=" ALL" Sequence="" >
     <Argument  Name="CalibrationFile" Type="dark" Default="AUTOMATIC" Desc='Name of thermal background file to subtract' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Update Spot Shifts for Flexure" IDLFunc="gpi_update_spot_shifts_for_flexure" Comment=" Extract a 3D datacube from a 2D image. Spatial integration (3 pixels) along the dispersion axis" Order=" 1.99" Type=" SpectralScience, Calibration, PolarimetricScience" Sequence="" >
     <Argument  Name="method" Type="string" Range="[None|Manual|Lookup|Auto]" Default="None" Desc='How to correct spot shifts due to flexure? [None|Manual|Lookup|Auto]' />
     <Argument  Name="manual_dx" Type="float" Range="[-10,10]" Default="0" Desc="If method=Manual, the X shift of spectra at the center of the detector" />
     <Argument  Name="manual_dy" Type="float" Range="[-10,10]" Default="0" Desc="If method=Manual, the Y shift of spectra at the center of the detector" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display diagnostic plot." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Update World Coordinates" IDLFunc="gpi_update_world_coordinates" Comment=" Add wcs info, assuming target star is precisely centered." Order=" 2.9" Type=" ALL" Sequence="" >
     <Argument  Name="CalibrationFile" Type="astrom" Default="AUTOMATIC" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="2D Wavelength Solution" IDLFunc="gpi_wavelength_solution_2d" Comment=" This primitive uses an existing wavelength solution file " Order=" 1.7" Type=" Calibration" Sequence="" >
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display diagnostic plot." />
     <Argument  Name="boxsizex" Type="Int" Range="[0,15]" Default="7" Desc="x dimension of a lenslet cutout" />
     <Argument  Name="boxsizey" Type="Int" Range="[0,50]" Default="24" Desc="y dimension of a lenslet cutout" />
     <Argument  Name="whichpsf" Type="Int" Range="[0,1]" Default="0" Desc="Type of psf 0;gaussian, 1;microlens" />
 </Primitive>
 <Primitive Name="Stores calibration in dataset" IDLFunc="store_calib_in_dataset" Comment=" Stores the current calibration into the dataset structure." Order=" 3.0" Type=" Calibration" Sequence=" " >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Test the measured angular separation and PA" IDLFunc="testcoordinates001" Comment=" Test the measured angular separation and PA" Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-test08" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the distortion correction" IDLFunc="testdistortion001" Comment=" Test the distortion correction" Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-disto" Desc="Enter suffix of figure name" />
     <Argument  Name="InFile" Type="string" Default="GPI-spdc.fits" Desc="Filename of input undistorted data to be read" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the extended object photometry" IDLFunc="testextendedobjectflux" Comment=" Test the algorithm of the Extended object photometric measurement by comparing it with DST debris disk inputs." Order=" 4.3" Type=" Testing" Sequence="" >
     <Argument  Name="ComparisonFile" Type="string" Default="E:\GPIdatabase\GPIreduced\testdata\input_ext1.fits" Desc="Enter DST input Stokes params" />
     <Argument  Name="suffix" Type="string"  Default="-ErrStokes" Desc="Enter suffix of figures names" />
     <Argument  Name="legendfig" Type="string"  Default="" Desc="If needed, enter a legend for figures" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
 </Primitive>
 <Primitive Name="Test the photometric calibration" IDLFunc="testphotometry001" Comment=" Test the photometry calibration by comparing extracted companion spectrum with DST initial spectrum." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the photometric calibration of an extented object" IDLFunc="testphotometryextented001" Comment=" Test the photometry calibration by comparing extracted companion spectrum with DST initial spectrum." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the astrometric calibration" IDLFunc="testplatescale001" Comment=" Test the plate scale and orientation" Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-satspotloc" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the polarization calibration measurement" IDLFunc="testpolcal001" Comment=" Test the algorithm of the polarization calibration measurement by comparing with DST-Zemax reference wavelength solution." Order=" 4.3" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-ErrPolcal" Desc="Enter suffix of figures names" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
 </Primitive>
 <Primitive Name="Test the satellite spot locations" IDLFunc="testsatspotloc001" Comment=" Test the satellite  spot locations" Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-satspotloc" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the speckle suppression algorithms." IDLFunc="testspecklesupr001" Comment=" Test the speckle suppression algorithms." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the speckle suppression algorithms." IDLFunc="testspecklesupr001__" Comment=" Test the speckle suppression algorithms." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the speckle suppression algorithms, plots" IDLFunc="testspecklesupr002" Comment=" Test the speckle suppression algorithms." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the speckle suppression algorithms of dual-channel polarimetry." IDLFunc="testspecklesuprpolar001" Comment=" Test the speckle suppression algorithms." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the speckle suppression algorithms of SDI." IDLFunc="testspecklesuprsdi001" Comment=" Test the speckle suppression algorithms." Order=" 2.52" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-photom" Desc="Enter suffix of figure name" />
     <Argument  Name="title" Type="string" Default="" Desc="Enter figure title" />
 </Primitive>
 <Primitive Name="Test the Stokes parameters measurement" IDLFunc="teststokesparam" Comment=" Test the algorithm of the Stokes parameters measurement by comparing them with DST Stokes parameter inputs." Order=" 4.3" Type=" Testing" Sequence="" >
     <Argument  Name="ComparisonFile" Type="string" Default="E:\GPIdatabase\GPIreduced\testdata\polscene_H_pol3.fits" Desc="Enter DST input Stokes params" />
     <Argument  Name="suffix" Type="string"  Default="-ErrStokes" Desc="Enter suffix of figures names" />
     <Argument  Name="legendfig" Type="string"  Default="" Desc="If needed, enter a legend for figures" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
 </Primitive>
 <Primitive Name="Test the wavelength solution measurement" IDLFunc="testwavcal001" Comment=" Test the algorithm of the wavelength solution measurement by comparing with DST-Zemax reference wavelength solution. DST package needed." Order=" 4.3" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-ErrWavcal" Desc="Enter suffix of figures names" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
 </Primitive>
 <Primitive Name="Test the wavelength solution measurement with vertical dispersion axis" IDLFunc="testwavcal002" Comment=" Test the algorithm of the wavelength solution measurement by comparing with DST-Zemax reference wavelength solution. DST package needed." Order=" 4.3" Type=" Testing" Sequence="" >
     <Argument  Name="suffix" Type="string"  Default="-ErrWavcal" Desc="Enter suffix of figures names" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
 </Primitive>
 <Primitive Name="plots using the wavelength solution" IDLFunc="wavcalplots" Comment=" plots using the wavelength solution" Order=" 2.51" Type=" Testing" Sequence=" " >
     <Argument  Name="ps_figure" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose # of saved fig suffix name, 0: no ps figure " />
     <Argument  Name="suffix" Type="string"  Default="-spec" Desc="Enter output suffix (fits)" />
 </Primitive>
</Config>
