<Config >
<!-- GPI DRP Primitives Config File - for pipepine, recipe editor, etc. 
This file was autogenerated by make_primitive_config.pro based on IDL doc headers -->
<!-- Module Names to IDL functions map -->
 <Primitive Name="Extract one spectrum, plots" IDLFunc="extract_one_spectrum2" Comment=" Extract one spectrum from a datacube somewhere in the FOV specified by the user." Order=" 2.51" Type=" SpectralScience" >
     <Argument  Name="xcenter" Type="int" Range="[0,1000]" Default="141" Desc="x-locations in pixel on datacube where extraction will be made" />
     <Argument  Name="ycenter" Type="int" Range="[0,1000]" Default="141" Desc="y-locations in pixel on datacube where extraction will be made" />
     <Argument  Name="radius" Type="float" Range="[0,1000]" Default="5." Desc="Aperture radius (in pixel i.e. mlens) to extract photometry for each wavelength. " />
     <Argument  Name="method" Type="string"  Default="total" Range="[median|mean|total]"  Desc="method of photometry extraction:median,mean,total" />
     <Argument  Name="ps_figure" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose # of saved fig suffix name, 0: no ps figure " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output (fits) on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-spec" Desc="Enter output suffix (fits)" />
 </Primitive>
 <Primitive Name="Assemble Spectral Datacube (bp)" IDLFunc="extractcube_withbadpix" Comment=" Extract a 3D datacube from a 2D image taking account of the hot/cold pixel map (need to use also readbadpixmap with this primitive)." Order=" 2.0" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-rawspdc" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Accumulate Images" IDLFunc="gpi_accumulate_images" Comment=" Stores images for combination by a subsequent primitive. Can buffer on disk for datasets too large to hold just in RAM." Order=" 4.0" Type=" ALL" >
     <Argument  Name="Method" Type="string" Range="OnDisk|InMemory" Default="InMemory" Desc="OnDisk|InMemory" />
 </Primitive>
 <Primitive Name="Add DISPERSR keyword if missing" IDLFunc="gpi_add_dispersr_if_missing" Comment=" Add missing DISPERSR keyword" Order=" 0.1" Type=" Calibration,Testing" >
     <Argument  Name="value" Default="DISP_PRISM_G6262" Desc="Enter value of the keyword to add." Type="string" Range="DISP_WOLLASTON_G6261|DISP_PRISM_G6262|DISP_OPEN_G6263" />
 </Primitive>
 <Primitive Name="Add Gemini and GPI keywords." IDLFunc="gpi_add_geminigpikeywords" Comment=" Add GPI and Gemini missing keywords. " Order=" 0.1" Type=" Testing" >
     <Argument  Name="overwrite" Type="int" Range="[0.0,1.0]" Default="0" Desc="0:do not overwrite already existent keyword; 1:overwrite" />
     <Argument  Name="exten" Type="int" Range="[0.0,1.0]" Default="0" Desc="Choose the extension num to place your keyword(s). 0 for FITS or MEF-PHU. 1 for extension1." />
     <Argument  Name="keyword1" Type="string"  Default="FILTER" Desc="Enter keyword name to add." />
     <Argument  Name="value1" Type="string"  Default="H" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword2" Type="string"  Default="OBSTYPE" Desc="Enter keyword name to add." />
     <Argument  Name="value2" Type="string"  Default="wavecal" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword3" Type="string"  Default="GCALLAMP" Desc="Enter keyword name to add." />
     <Argument  Name="value3" Type="string"  Default="Xenon" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword4" Type="string"  Default="PRISM" Desc="Enter keyword name to add." />
     <Argument  Name="value4" Type="string"  Default="Spectral" Desc="Enter value of the keyword to add." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-keyw" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Add missing keywords for RA, DEC, PAR_ANG" IDLFunc="gpi_add_missing_coords_keywords" Comment=" Add missing RA, DEC, PAR_ANG keywords based on a lookup table of objects or SIMBAD." Order=" 0.1" Type=" Calibration,Testing" >
     <Argument  Name="CalibrationFile" Type="string" Default="${GPI_DRP_CONFIG_DIR}object_coordinates.txt" Desc="File containing names, RA, Dec for targets." />
     <Argument  Name="OBJECT" Default="NO CHANGE" Desc="Enter value here to override the OBJECT keyword of a given file" />
 </Primitive>
 <Primitive Name="Add missing keyword" IDLFunc="gpi_add_missingkeyword" Comment=" Add any missing keyword. (use this function several times in the DRF if you need to add more than one keyword)" Order=" 0.1" Type=" Calibration,Testing" >
     <Argument  Name="keyword" Type="string"  Default="" Desc="Enter keyword name to add." />
     <Argument  Name="value" Type="string" Default="" Desc="Enter value of the keyword to add." />
     <Argument  Name="valuetype" Type="string" Default="string" Desc="Enter keyword type." />
     <Argument  Name="ext_no" Type="int" Default="0" Desc="Extension Number." />
 </Primitive>
 <Primitive Name="Add multi missing keywords." IDLFunc="gpi_add_multimissingkeyword" Comment=" Add any missing keyword. (use this function several times in the DRF if you need to add more than one keyword)" Order=" 0.1" Type=" Testing" >
     <Argument  Name="keyword1" Type="string"  Default="FILTER" Desc="Enter keyword name to add." />
     <Argument  Name="value1" Type=""  Default="H" Desc="Enter value of the keyword to add." />
     <Argument  Name="keyword2" Type="string"  Default="OBSTYPE" Desc="Enter keyword name to add." />
     <Argument  Name="value2" Type=""  Default="Xenon" Desc="Enter value of the keyword to add." />
 </Primitive>
 <Primitive Name="ADI with LOCI" IDLFunc="gpi_adi_with_loci" Comment=" Implements the LOCI ADI algorithm (Lafreniere et al. 2007)" Order=" 4.11" Type=" SpectralScience" >
     <Argument  Name="nfwhm" Type="float" Range="[0,20]" Default="1.5" Desc="number of FWHM to calculate the minimal distance for reference calculation" />
     <Argument  Name="coeff_type" Type="int" Range="[0,1]" Default="0" Desc="0: positive and negative 1: positive only Coefficients in LOCI algorithm" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Apply Reference Pixel Correction" IDLFunc="gpi_apply_reference_pixel_correction" Comment=" Subtract channel bias levels and bias drift stripes using H2RG reference pixels." Order=" 1.25" Type=" ALL" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display "  />
     <Argument  Name="smoothing_size" Type="int" Range="[0,500]" Default="31" Desc="Smoothing kernel size for smoothed_horizontal method.  "  />
     <Argument  Name="before_and_after" Type="int" Range="[0,1]" Default="0" Desc="Show the before-and-after images for the user to see?" />
     <Argument  Name="Method" Type="enum" Range="SIMPLE_CHANNELS|SIMPLE_HORIZONTAL|SMOOTHED_HORIZONTAL|INTERPOLATED"  Default="INTERPOLATED" Desc="Algorithm for reference pixel subtraction." />
 </Primitive>
 <Primitive Name="Assemble Datacube" IDLFunc="gpi_assemble_datacube" Comment=" Extract a 3D datacube from a 2D image (Calls assemble spectral or polarimetric cube automatically depending on input data format)" Order=" 2.0" Type=" Testing" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" />
 </Primitive>
 <Primitive Name="Assemble Polarization Cube" IDLFunc="gpi_assemble_polarization_cube" Comment=" Extract 2 perpendicular polarizations from a 2D image." Order=" 2.0" Type=" PolarimetricScience, Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="Method" Type="String" Range="BOX|PSF" Default="BOX" Desc="Method for pol cube reconstruction, simple box or optimal PSF" />
 </Primitive>
 <Primitive Name="Assemble Spectral Datacube" IDLFunc="gpi_assemble_spectral_datacube" Comment=" Assemble a 3D datacube from a 2D image. Spatial integration (3 pixels box) along the dispersion axis" Order=" 2.0" Type=" SpectralScience, Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Assemble Undispersed Image" IDLFunc="gpi_assemble_undispersed_image" Comment=" Extract a 2D image from a raw undispersed mode image. Box integration of the light from each lenslet." Order=" 2.0" Type=" Calibration" >
     <Argument  Name="xshift" Type="float" Range="[-100,100]" Default="-2.363" Desc="Shift in X direction" />
     <Argument  Name="yshift" Type="float" Range="[-100,100]" Default="-2.6134" Desc="Shift in Y direction" />
     <Argument  Name="boxsize" Type="float" Range="[0,10]" Default="5" Desc="Size of box to use for spectral extraction" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-extu" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Basic ADI" IDLFunc="gpi_basic_adi" Comment=" Implements the basic ADI algorithm described by Marois et al. (2006)." Order=" 4.1" Type=" SpectralScience" >
     <Argument  Name="numimmed" Type="int" Range="[1,100]" Default="3" Desc="number of images for the calculation of the PSF reference" />
     <Argument  Name="nfwhm" Type="float" Range="[0,20]" Default="1.5" Desc="number of FWHM to calculate the minimal distance for reference calculation" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Calibrate astrometry from binary (using 6th orbit catalog)" IDLFunc="gpi_calibrate_astrometry_from_binary_orbit_catalog" Comment=" Calculate astrometry from unocculted binaries; Calculate Separation and PA at date DATEOBS using the sixth orbit catalog." Order=" 2.61" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Calibrate astrometry from binary (using separation and PA)" IDLFunc="gpi_calibrate_astrometry_from_binary_position" Comment=" Calculate astrometry from unocculted binaries using user-specified separation and PA at DATEOBS" Order=" 2.6" Type=" Calibration" >
     <Argument  Name="separation" Type="float" Range="[0.,4.]" Default="1." Desc="Separation [arcsec] at date DATEOBS of observation of the binaries" />
     <Argument  Name="pa" Type="float" Range="[0.,360.]" Default="4.8" Desc="Position angle [degree] at date DATEOBS of observation of the binaries" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Calibrate Photometric Flux" IDLFunc="gpi_calibrate_photometric_flux" Comment=" Apply photometric calibration to a single or set of datacubes" Order=" 2.51" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="extraction_radius" Type="float" Range="[0,1000]" Default="3." Desc="Aperture radius at middle wavelength (in spaxels i.e. mlens) to extract photometry for each wavelength. " />
     <Argument  Name="inner_sky_radius" Type="float" Range="[1,100]" Default="10." Desc="Inner aperture radius at middle wavelength (in spaxels i.e. mlens) to extract sky for each wavelength. " />
     <Argument  Name="outer_sky_radius" Type="float" Range="[1,100]" Default="15." Desc="Outer aperture radius at middle wavelength (in spaxels i.e. mlens) to extract sky for each wavelength. " />
     <Argument  Name="c_ap_scaling" Type="int" Range="[0,1]" Default="1" Desc="Perform aperture scaling with wavelength?" />
     <Argument  Name="calib_cube_name" Type="string" Default="" Desc="Leave blank to use satellites of this cube, or enter a file to use those satellites" />
     <Argument  Name="calib_model_spectrum" Type="string" Default="" Desc="Leave blank to use satellites of this cube, or enter a file to use with the spectrum for the satellites" />
     <Argument  Name="calib_spectrum" Type="string" Default="" Desc="Leave blank to use satellites of this cube, or enter calibrated spectrum file" />
     <Argument  Name="FinalUnits" Type="int" Range="[0,10]" Default="1" Desc="0: ADU per coadd, 1: ADU/s, 2: ph/s/nm/m^2, 3: Jy, 4: 'W/m^2/um, 5: ergs/s/cm^2/A, 6: ergs/s/cm^2/Hz'" />
 </Primitive>
 <Primitive Name="Check for closed-loop coronagraphic image" IDLFunc="gpi_check_coronagraph_status" Comment="  Check whether file represents a closed-loop  coronagraphic image." Order=" 2.41" Type=" Calibration,SpectralScience,PolarimetricScience" >
     <Argument  Name="err_on_false" Type="int"  Range="[0,1]" Default="0" Desc=" If false, 0: continue to next image; 1: Throw error" />
 </Primitive>
 <Primitive Name="Check Data Quality" IDLFunc="gpi_check_data_quality" Comment=" Check quality of data based on header keywords. For bad data, can fail the reduction or simply alert the user." Order=" 0.9" Type=" ALL" >
     <Argument  Name="Action" Type="int" Range="[0,10]" Default="1" Desc="0:Simple alert and continue reduction, 1:Reduction fails" />
     <Argument  Name="r0" Type="float" Range="[0,2]" Default="0.08" Desc="critical r0 [m] at lambda=0.5microns" />
     <Argument  Name="rmserr" Type="float" Range="[0,1000]" Default="10." Desc="Critical rms wavefront error in microns. " />
 </Primitive>
 <Primitive Name="Clean Cosmic Rays" IDLFunc="gpi_clean_cosmic_rays" Comment=" Placeholder for cosmic ray rejection (if needed; not currently implemented!)" Order=" 1.23" Type=" HIDDEN" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Clean Polarization Pairs via Double Difference" IDLFunc="gpi_clean_polarization_pairs_dd" Comment="" Order=" 4.05" Type=" PolarimetricScience,Calibration" >
     <Argument  Name="fix_badpix" Type="int" Range="[0,1]" Default="1" Desc="Also locate statistical outlier bad pixels and repair via interpolation?" />
     <Argument  Name="Save_diffbias" Type="int" Range="[0,1]" Default="0" Desc="Save the difference image systematic bias estimate subtracted from each pair?" />
     <Argument  Name="gpitv_diffbias" Type="int" Range="[0,500]" Default="10" Desc="Display empirical systematic bias in difference frames in a GPITV session 1-500, or 0 for  no display " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="debug" Type="int" Range="[0,1]" Default="0" Desc="Stop at breakpoints for debug/test" />
 </Primitive>
 <Primitive Name="Collapse datacube" IDLFunc="gpi_collapse_datacube" Comment=" Collapse the wavelength dimension of a datacube via mean, median or total. " Order=" 2.6" Type=" ALL" >
     <Argument  Name="Method" Type="enum" Range="MEDIAN|TOTAL"  Default="TOTAL" Desc="How to collapse datacube: total or median (with flux conservation)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="ReuseOutput" Type="int" Range="[0,1]" Default="1" Desc="1: keep output for following primitives, 0: don't keep" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 2D dark images" IDLFunc="gpi_combine_2d_dark_images" Comment=" Combine 2D dark images into a master file via mean or median. " Order=" 4.01" Type=" Calibration" >
     <Argument  Name="Method" Type="string" Range="MEAN|MEDIAN|SIGMACLIP"  Default="SIGMACLIP" Desc="How to combine images: median, mean, or mean with outlier rejection?[MEAN|MEDIAN|SIGMACLIP]" />
     <Argument  Name="Sigma_cut" Type="float" Range="[1,100]" Default="3" Desc="If Method=SIGMACLIP, then data points more than this many standard deviations away from the median value of a given pixel will be discarded. " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 2D images" IDLFunc="gpi_combine_2d_images" Comment=" Combine 2D images such as darks into a master file via mean or median. " Order=" 1.5" Type=" ALL" >
     <Argument  Name="Method" Type="string" Range="MEAN|MEDIAN|SIGMACLIP"  Default="SIGMACLIP" Desc="How to combine images: median, mean, or mean with outlier rejection?[MEAN|MEDIAN|SIGMACLIP]" />
     <Argument  Name="Sigma_cut" Type="float" Range="[1,100]" Default="3" Desc="If Method=SIGMACLIP, then data points more than this many standard deviations away from the median value of a given pixel will be discarded. " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 2D Thermal/Sky Backgrounds" IDLFunc="gpi_combine_2d_thermal_sky_backgrounds" Comment=" Combine 2D images with measurement of thermal or sky background" Order=" 1.51" Type=" Calibration" >
     <Argument  Name="Method" Type="enum" Range="MEAN|MEDIAN|SIGMACLIP"  Default="SIGMACLIP" Desc="How to combine images: median, mean, or mean with outlier rejection?[MEAN|MEDIAN|SIGMACLIP]" />
     <Argument  Name="Sigma_cut" Type="float" Range="[1,100]" Default="3" Desc="If Method=SIGMACLIP, then data points more than this many standard deviations away from the median value of a given pixel will be discarded. " />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine 3D Datacubes" IDLFunc="gpi_combine_3d_datacubes" Comment=" Combine 3D datacubes via mean or median. " Order=" 4.5" Type=" ALL" >
     <Argument  Name="Method" Type="enum" Range="MEAN|MEDIAN|SIGMACLIP|MINIMUM"  Default="MEDIAN" Desc="How to combine images: median, mean, or mean with outlier rejection?" />
     <Argument  Name="sig_clip" Type="int" Range="0,10" Default="3" Desc="Clipping value to be used with SIGMACLIP in sigma (stddev)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Polarization Sequence" IDLFunc="gpi_combine_polarization_sequence" Comment="" Order=" 4.4" Type=" PolarimetricScience,Calibration" >
     <Argument  Name="HWPoffset" Type="float" Range="[-360.,360.]" Default="-29.14" Desc="The internal offset of the HWP. If unknown set to 0" />
     <Argument  Name="IncludeSystemMueller" Type="int" Range="[0,1]" Default="0" Desc="1: Include, 0: Don't" />
     <Argument  Name="IncludeSkyRotation" Type="int" Range="[0,1]" Default="1" Desc="1: Include, 0: Don't" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Polarization Sequence via Double Difference" IDLFunc="gpi_combine_polarizations_dd" Comment="" Order=" 4.4" Type=" PolarimetricScience,Calibration" >
     <Argument  Name="HWPoffset" Type="float" Range="[-360.,360.]" Default="-29.14" Desc="The internal offset of the HWP. If unknown set to 0" />
     <Argument  Name="IncludeSystemMueller" Type="int" Range="[0,1]" Default="1" Desc="1: Include, 0: Don't" />
     <Argument  Name="IncludeSkyRotation" Type="int" Range="[0,1]" Default="1" Desc="1: Include, 0: Don't" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Wavelength Calibrations locations" IDLFunc="gpi_combine_wavcal_locations_all" Comment=" Combine wavelength calibration from  flat and arc" Order=" 4.2" Type=" Calibration" >
     <Argument  Name="polydegree" Type="int" Range="[1,2]" Default="1" Desc="1: linear wavelength solution, 2: quadratic wav. sol." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Combine Wavelength Calibrations" IDLFunc="gpi_combine_wavelength_calibrations" Comment=" Performs simple median combination of wavelength calibrations from flat and/or arc lamps" Order=" 4.2" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Copy keyword values to another keyword." IDLFunc="gpi_copykeywordvalue" Comment=" Copy keyword values to other keywords. " Order=" 0.12" Type=" Testing" >
     <Argument  Name="overwrite" Type="int"  Default="0" Desc="0:do not overwrite already existent keyword; 1:overwrite" />
     <Argument  Name="keyw_source_1" Type="string"  Default="OBJECT" Desc="Enter keyword name to copy its value to keyw_target_1." />
     <Argument  Name="keyw_target_1" Type="string"  Default="GCALLAMP" Desc="Enter keyword name that will receive value of keyw_source_1." />
     <Argument  Name="keyw_source_2" Type="string"  Default="OBJECT" Desc="Enter keyword name to copy its value to keyw_target_2." />
     <Argument  Name="keyw_target_2" Type="string"  Default="GCALSHUT" Desc="Enter keyword name that will receive value of keyw_source_2." />
     <Argument  Name="keyw_source_3" Type="string"  Default="OBJECT" Desc="Enter keyword name to copy its value to keyw_target_2." />
     <Argument  Name="keyw_target_3" Type="string"  Default="OBSTYPE" Desc="Enter keyword name that will receive value of keyw_source_2." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="suffix" Type="string"  Default="-keyw" Desc="Enter output suffix" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Correct Distortion" IDLFunc="gpi_correct_distortion" Comment=" Correct GPI distortion" Order=" 2.44" Type=" SpectralScience,PolarimetricScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="CalibrationFile" Type="string" CalFileType="distorcal" Default="AUTOMATIC" Desc="Filename of the desired distortion calibration file to be read" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create 2D Low Frequency Flat" IDLFunc="gpi_create_2d_low_frequency_flat" Comment=" Create Low Frequency Flat 2D from polarimetry flats" Order=" 4.01" Type=" HIDDEN" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create Bad Pixel Map from text list of pixels" IDLFunc="gpi_create_bad_pixel_map_from_list" Comment=" Generate FITS bad pixel map from an ASCII text list of pixel coords X, Y" Order=" 4.01" Type=" Testing" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="bptype" Type="string" Range="hotbadpix|coldbadpix|nonlinearbadpix" Default="coldbadpix" Desc="Type of bad pixel mask to write" />
     <Argument  Name="CalibrationFile" Type="string" Default="AUTOMATIC" Desc="Input ASCII pixel list file" />
 </Primitive>
 <Primitive Name="Create Lenslet Flat Field" IDLFunc="gpi_create_lenslet_flat_field" Comment=" Create a 2D flat field for wavelength-independent lenslet throughput variations." Order=" 3.1992" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create microphonics noise model" IDLFunc="gpi_create_microphonics_noise_model" Comment=" Create a microphonics noise model in Fourier space." Order=" 4.01" Type=" Calibration" >
     <Argument  Name="Gauss_Interp" Type="int" Range="[0,1]" Default="0" Desc="1: Interpolate each peak by a 2d gaussian, 0: don't interpolate" />
     <Argument  Name="Combining_Method" Type="string" Range="ADD|MEDIAN" Default="ADD" Desc="Method to combine the Fourier transforms of the microphonics (ADD|MEDIAN)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Creates a thermal/sky background datacube" IDLFunc="gpi_create_sky_bkgd_cube" Comment=" Create Sky/Thermal background cubes " Order=" 4.01" Type=" Calibration" >
     <Argument  Name="smooth_box_size" Type="int" Range="[0,100]" Default="3" Desc="Size of box to smooth by (0: No smooth)" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Create Symbolic Links" IDLFunc="gpi_create_symlinks" Comment=" Create symbolic links on the file system for files either input to or output from the data pipeline." Order=" 5.0" Type=" Testing" >
     <Argument  Name="filetolink" Type="string" Default="INPUT_FILE" Desc="File to create a link for. Either 'INPUT_FILE', 'LAST_OUTPUT_FILE', or the specific filename of some existing disk file" />
     <Argument  Name="createlinkdir" Type="string" Default="${GPI_REDUCED_DATA_DIR}" Desc="Directory to create a link in. Must be a directory, not any other filename." />
     <Argument  Name="appenddatedir" Type="int" Range="[0,1]" Default="1" Desc="Append the YYMMDD date string to createlinkdir" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Destripe for Darks Only" IDLFunc="gpi_destripe_for_darks_only" Comment=" Subtract readout pickup noise using median across all channels. This is an aggressive destriping algorithm suitable only for use on images that have no light. Also includes microphonics noise removal." Order=" 1.35" Type=" Calibration" >
     <Argument  Name="remove_microphonics" Type="string" Range="[yes|no]" Default="yes" Desc='Attempt to remove microphonics noise via Fourier filtering?' />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window else = Window number to display diagonostics in." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display "  />
 </Primitive>
 <Primitive Name="Destripe science image" IDLFunc="gpi_destripe_science_image" Comment="  Subtract detector striping using measurements between the microspectra" Order=" 1.35" Type=" SpectralScience,Calibration, PolarimetricScience" >
     <Argument  Name="method" Type="string" Range="[threshhold|calfile]" Default="calfile" Desc='Find background based on image value threshhold cut, or calibration file spectra/spot locations?' />
     <Argument  Name="abort_fraction" Type="float" Range="[0.0,1.0]" Default="0.9" Desc="Necessary fraction of pixels in mask to continue - set at 0.9 to ensure quicklook tool is robust" />
     <Argument  Name="`chan_offset_correction" Type="int" Range="[0,1]" Default="0" Desc="Tries to correct for channel bias offsets - useful when no dark is available" />
     <Argument  Name="readnoise_floor" Type="float" Range="[0.0,100]" Default="0.0" Desc="Readnoise floor in ADU. 0 = default to 8 electrons per CDS image" />
     <Argument  Name="Save_stripes" Type="int" Range="[0,1]" Default="0" Desc="Save the striping noise image subtracted from frame?" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window else = Window number to display diagonostics in." />
     <Argument  Name="remove_microphonics" Type="int" Range="[0,2]" Default="0" Desc='Remove microphonics noise based on a precomputed fixed model.0: not applied. 1: applied. 2: the algoritm is applied only if the measured noise is greater than micro_threshold' />
     <Argument  Name="method_microphonics" Type="int" Range="[1,3]" Default="0" Desc='Method applied for microphonics 1: model projection. 2: all to zero 3: gaussian fit' />
     <Argument  Name="CalibrationFile" Type="string" CalFileType="micro" Default="AUTOMATIC" Desc="Filename of the desired microphonics model file to be read" />
     <Argument  Name="Plot_micro_peaks" Type="string" Range="[yes|no]" Default="no" Desc="Plot in 3d the peaks corresponding to the microphonics" />
     <Argument  Name="save_microphonics" Type="string" Range="[yes|no]" Default="no" Desc='If remove_microphonics = 1 or (auto and micro_threshold overpassed), save the removed microphonics' />
     <Argument  Name="micro_threshold" Type="float" Range="[0.0,1.0]" Default="0.01" Desc='If remove_microphonics = 2, set the threshold. This value is sum(abs(fft(image))*abs(fft(noise_model)))/sqrt(sum(image^2))' />
     <Argument  Name="write_mask" Type="int" Range="[0,1]" Default="0" Desc='write signal mask to reduced directory?' />
     <Argument  Name="fraction" Type="float" Range="[0.0,1.0]" Default="0.7" Desc="Threshold fraction of the total pixels in a row should be masked" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: Save output to disk, 0: Don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Display raw image with GPItv" IDLFunc="gpi_display_raw_image_with_gpitv" Comment=" Display, with GPItv, raw data to be processed  " Order=" 0.01" Type=" ALL, HIDDEN" >
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0 for no display " />
 </Primitive>
 <Primitive Name="Divide by Lenslet Flat Field" IDLFunc="gpi_divide_by_lenslet_flat_field" Comment=" Divides a spectral data-cube by a flat field data-cube." Order=" 2.2" Type=" SpectralScience,PolarimetricScience,Calibration" >
     <Argument  Name="CalibrationFile" Type="string" CalFileType="lensletflat" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Divide by Polarized Flat Field" IDLFunc="gpi_divide_by_polarized_flat_field" Comment=" Divides a 2-slice polarimetry file by a flat field." Order=" 3.5" Type=" PolarimetricScience, Calibration" >
     <Argument  Name="CalibrationFile" Type="String" CalFileType="polflat" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Divide by Spectral Flat Field" IDLFunc="gpi_divide_by_spectral_flat_field" Comment=" Divides a spectral data-cube by a flat field data-cube." Order=" 2.2" Type=" SpectralScience,Calibration" >
     <Argument  Name="CalibrationFile" Type="string" CalFileType="specflat" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Extract 1D spectrum from a datacube" IDLFunc="gpi_extract_1d_spectrum" Comment=" Extract one spectrum from a datacube somewhere in the FOV specified by the user." Order=" 2.52" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="xcenter" Type="float" Range="[-1,280]" Default="-1" Desc="x-location in pixels on datacube where extraction will be made" />
     <Argument  Name="ycenter" Type="float" Range="[-1,280]" Default="-1" Desc="y-location in pixels on datacube where extraction will be made" />
     <Argument  Name="highpass" Type="int" Range="[0,25]" Default="0" Desc="highpass filter box size for centroiding" />
     <Argument  Name="no_centroid_override" Type="int" Range="[0,1]" Default="0" Desc="Do not centroid on extraction source?" />
     <Argument  Name="inner_sky_radius" Type="float" Range="[1,100]" Default="10." Desc="Inner aperture radius at middle wavelength slice (in spaxels i.e. mlens) to extract sky" />
     <Argument  Name="outer_sky_radius" Type="float" Range="[1,100]" Default="20." Desc="Outer aperture radius at middle wavelength slice (in spaxels i.e. mlens) to extract sky" />
     <Argument  Name="override" Type="int" Range="[0,1]" Default="0" Desc="Override apertures/scaling from spectrophotometric calibration?" />
     <Argument  Name="extraction_radius" Type="float" Range="[0,1000]" Default="5." Desc="Aperture radius at middle wavelength (in spaxels i.e. mlens) to extract photometry for each wavelength. (only active if Override is set)" />
     <Argument  Name="c_ap_scaling" Type="int" Range="[0,1]" Default="1" Desc="Perform aperture scaling with wavelength?" />
     <Argument  Name="display" Type="int" Range="[-1,100]" Default="17" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display diagnostic plot." />
     <Argument  Name="save_ps_plot" Type="int" Range="[0,1]" Default="0" Desc="Save PostScript of plot?" />
     <Argument  Name="write_ascii_file" Type="int" Range="[0,1]" Default="0" Desc="Save ascii file of spectrum (.dat)?" />
 </Primitive>
 <Primitive Name="Measure locations of Emission Lines" IDLFunc="gpi_extract_wavcal_locations" Comment=" Derive wavelength calibration from an arc lamp or flat-field image." Order=" 1.73" Type=" Testing" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.8" Desc="Spectral spacing perpendicular to the dispersion axis at the detcetor in pixel" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="-1.8" Desc="Micro-pupil pattern" />
     <Argument  Name="wav_of_centrXYpos" Type="int" Range="[1,2]" Default="2" Desc="1 if centrX-Ypos is the smallest-wavelength peak of the band; 2 if centrX-Ypos refer to 1.5microns" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2." Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="maxtilt" Type="float" Range="[-360.,360.]" Default="10." Desc="Allowed maximum tilt fluctuation (in degree) between adjacent mlens" />
     <Argument  Name="medfilter" Type="int" Range="[0,1]" Default="1" Desc="1: Median filtering of dispersion coeff and tilts with a (5x5) median filtering" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
     <Argument  Name="tests" Type="int" Range="[0,3]" Default="0" Desc="1 for extensive tests " />
 </Primitive>
 <Primitive Name="Find Cold Bad Pixels from Flats" IDLFunc="gpi_find_cold_bad_pixels_from_flats" Comment=" Find cold pixels from a stack of flat images using all different filters" Order=" 4.01" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Find Hot Bad Pixels from Darks" IDLFunc="gpi_find_hot_bad_pixels_from_darks" Comment=" Find hot pixels from a stack of dark images (best with deep integration darks)" Order=" 4.01" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="hot_bad_thresh" Type="float" Range="[0,100.]"  Default="1.0" Desc="Threshhold to consider a hot pixel bad, in electrons/second." />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Flag Quicklook" IDLFunc="gpi_flag_quicklook" Comment=" Flag a given reduction output as 'quicklook' quality rather than science grade." Order=" 0.1" Type=" ALL" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: Save output to disk, 0: Don't save" />
 </Primitive>
 <Primitive Name="Generate Combined Bad Pixel Map" IDLFunc="gpi_generate_combined_bad_pixel_map" Comment=" This routine combines various sub-types of bad pixel mask (hot, cold,  anomalous nonlinear pixels) to generate a master bad pixel list." Order=" 4.02" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Insert Planet into datacube" IDLFunc="gpi_insert_planet_into_cube" Comment=" This primitive inserts planets into reduced datacubes. It can be run multiple times to insert multiple planets. " Order=" 5.0" Type=" SpectralScience" >
     <Argument  Name="Age" Type="int" Range="[1,1000]"  Default="10" Desc="Age of planet in Myr" />
     <Argument  Name="Mass" Type="int" Range="[1,15]"  Default="10" Desc="Mass of planet in Jupiter masses" />
     <Argument  Name="model_type" Type="string" Range="[hot,cold]"  Default="hot" Desc="Hot or Cold Start formation scenario" />
     <Argument  Name="position_angle" Type="float" Range="[0,360]"  Default="45.0" Desc="Position angle of the planet in degrees East of North" />
     <Argument  Name="Separation" Type="float" Range="[0,1800]"  Default="500" Desc="Separation in milli-arcseconds" />
     <Argument  Name="Star_Mag" Type="float" Range="[-1,8]"  Default="-1" Desc="Stellar Magnitude in H band, -1 estimates stellar magnitude from satellite spots" />
     <Argument  Name="distance" Type="float" Range="[0,1000]"  Default="10.0" Desc="distance to system in parsecs" />
     <Argument  Name="write_header_info" Type="int" Range="[0,1]" Default="1" Desc="1: Write planet info to headers 0: don't write planet info to headers" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Interpolate bad pixels in 2D frame" IDLFunc="gpi_interpolate_bad_pixels_in_2d_frame" Comment="  Repair bad pixels by interpolating between their neighbors. Can optionally just flag as NaNs or else interpolate." Order=" 1.4 " Type=" SpectralScience, PolarimetricScience, Calibration" >
     <Argument  Name="CalibrationFile" type="string" CalFileType='badpix' default="AUTOMATIC" Desc="Filename of the desired bad pixel file to be read" />
     <Argument  Name="method" Type="string" Range="[n4n|vertical|all8]" Default="vertical" Desc='Repair bad bix interpolating all 8 neighboring pixels, or just the 2 vertical ones, or just flag as NaN (n4n)?' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="negative_bad_thresh" Type="float" Range="[-100000,0]" Default="-50" Desc="Pixels more negative than this should be considered bad. " />
     <Argument  Name="before_and_after" Type="int" Range="[0,1]" Default="0" Desc="Show the before-and-after images for the user to see? (for debugging/testing)" />
 </Primitive>
 <Primitive Name="Interpolate bad pixels in cube" IDLFunc="gpi_interpolate_bad_pixels_in_cube" Comment="  Repair bad pixels by interpolating between their neighbors. " Order=" 2.5" Type=" SpectralScience, PolarimetricScience, Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="before_and_after" Type="int" Range="[0,1]" Default="0" Desc="Show the before-and-after images for the user to see? (for debugging/testing)" />
 </Primitive>
 <Primitive Name="Interpolate Wavelength Axis" IDLFunc="gpi_interpolate_wavelength_axis" Comment=" Interpolate spectral datacube onto regular wavelength sampling." Order=" 2.3" Type=" SpectralScience,Calibration" >
     <Argument  Name="Spectralchannels" Type="int" Range="[0,100]" Default="37" Desc="Choose how many spectral channels for output datacube" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Advanced KLIP ADI for Pol Mode" IDLFunc="gpi_klip_adi_pol_adv" Comment=" Reduce speckle noise using the KLIP algorithm with ADI data" Order=" 4.2" Type=" PolarimetricScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="0" Desc="Number of annuli to use" />
     <Argument  Name="MinRotation" Type="float" Range="[0.0,360.0]" Default="1" Desc="Minimum rotation between images (degrees)" />
     <Argument  Name="CollapsePol" Type="int" Range="[0,1]" Default="0" Desc="Collapse the pol cube and perform KLIP on the total intensity?" />
     <Argument  Name="Mask" Type="int" Range="[0,1]" Default="0" Desc="Do you want to mask out any area? If so you must provide a list of mask files" />
     <Argument  Name="MaskList" Type="string" Default="MaskList.txt" Desc="The name of a file containing a list of mask files corresponding to each " />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="KLIP algorithm Angular Differential Imaging" IDLFunc="gpi_klip_algorithm_angular_differential_imaging" Comment=" Reduce speckle noise using the KLIP algorithm with ADI data" Order=" 4.2" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="0" Desc="Number of annuli to use" />
     <Argument  Name="MinRotation" Type="float" Range="[0.0,360.0]" Default="1" Desc="Minimum rotation between images (degrees)" />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="KLIP algorithm Angular Differential Imaging With Center Forced" IDLFunc="gpi_klip_algorithm_angular_differential_imaging_forcecent" Comment=" Reduce speckle noise using the KLIP algorithm with ADI data with center forced to image center" Order=" 4.2" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="0" Desc="Number of annuli to use" />
     <Argument  Name="centerx" Type="int" Range="[0,281]" Default="140" Desc="Center X Pixel" />
     <Argument  Name="centery" Type="int" Range="[0,281]" Default="140" Desc="Center Y Pixel" />
     <Argument  Name="MinRotation" Type="float" Range="[0.0,360.0]" Default="1" Desc="Minimum rotation between images (degrees)" />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="KLIP ADI for Pol Mode" IDLFunc="gpi_klip_algorithm_angular_differential_imaging_pol" Comment=" Reduce speckle noise using the KLIP algorithm with ADI data" Order=" 4.2" Type=" PolarimetricScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="0" Desc="Number of annuli to use" />
     <Argument  Name="MinRotation" Type="float" Range="[0.0,360.0]" Default="1" Desc="Minimum rotation between images (degrees)" />
     <Argument  Name="CollapsePol" Type="int" Range="[0,1]" Default="0" Desc="Collapse the pol cube and perform KLIP on the total intensity?" />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="KLIP algorithm Spectral Differential Imaging" IDLFunc="gpi_klip_algorithm_spectral_differential_imaging" Comment=" Reduce speckle noise using the KLIP algorithm across the spectral axis of a datacube." Order=" 2.8" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="refslice" Type="int" Range="[0,100]" Default="0" Desc="Slice of the reference PSF" />
     <Argument  Name="annuli" Type="int" Range="[0,100]" Default="5" Desc="Number of annuli used" />
     <Argument  Name="movement" Type="float" Range="[0.0,5.0]" Default="2.0" Desc="Minimum pixel movement for reference set" />
     <Argument  Name="prop" Type="float" Range="[0.8,1.0]" Default=".99999" Desc="Proportion of eigenvalues used to truncate KL transform vectors" />
     <Argument  Name="arcsec" Type="float" Range="[0.0,1.0]" Default=".4" Desc="Radius of interest if using 1 annulus" />
     <Argument  Name="signal" Type="int" Range="[0,1]" Default="0" Desc="1: calculate signal to noise ration, 0: don't calculate" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Load High-Res PSFs" IDLFunc="gpi_load_highres_psfs" Comment=" Reads a high-res PSF file from disk. This primitive is required for PSF cube extraction." Order=" 0.5" Type=" SpectralScience,Calibration" >
     <Argument  Name="CalibrationFile" Type='String' CalFileType="mlenspsf" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
 </Primitive>
 <Primitive Name="Load Instrumental Polarization Calibration" IDLFunc="gpi_load_instrumental_polarization_calibration" Comment=" Load a calibration file for the instrumental polarization." Order=" 0.52" Type=" PolarimetricScience,Calibration" >
     <Argument  Name="CalibrationFile" Type='String' CalFileType="instpol" Default="AUTOMATIC" Desc="Filename of the desired instrumental polarization file to be read"  />
 </Primitive>
 <Primitive Name="Load Polarimetry Spot Calibration" IDLFunc="gpi_load_polarimetry_spot_calibration" Comment=" Reads a pol spot calibration file from disk. This primitive is required for any polarimetry data-cube extraction." Order=" 0.51" Type=" PolarimetricScience,Calibration" >
     <Argument  Name="CalibrationFile" Type="String" CalFileType="polcal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
 </Primitive>
 <Primitive Name="Load Wavelength Calibration" IDLFunc="gpi_load_wavelength_calibration" Comment=" Reads a wavelength calibration file from disk. This primitive is required for any data-cube extraction." Order=" 0.5" Type=" SpectralScience,Calibration" >
     <Argument  Name="CalibrationFile" Type='String' CalFileType="wavecal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
 </Primitive>
 <Primitive Name="Plot the satellite spot locations vs. the expected location from wavelength scaling" IDLFunc="gpi_meas_satspot_dev" Comment=" Measured vs. wavelength scaled sat spot locations" Order=" 2.7" Type=" SpectralScience" >
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display in." />
     <Argument  Name="SaveData" Type="string" Default="" Desc="Save data to filename (blank for no save)" />
     <Argument  Name="SavePNG" Type="string" Default="" Desc="Save plot to filename as PNG(blank for no save)" />
 </Primitive>
 <Primitive Name="Measure Contrast" IDLFunc="gpi_measure_contrast" Comment=" Measure the contrast. Save as PNG or FITS table." Order=" 2.7" Type=" SpectralScience,PolarimetricScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display in." />
     <Argument  Name="SaveProfile" Type="string" Default="" Desc="Save radial profile to filename as FITS (blank for no save, dir name for default naming, AUTO for auto full path)" />
     <Argument  Name="SavePNG" Type="string" Default="" Desc="Save plot to filename as PNG (blank for no save, dir name for default naming, AUTO for auto full path) " />
     <Argument  Name="contrsigma" Type="float" Range="[0.,20.]" Default="5." Desc="Contrast sigma limit" />
     <Argument  Name="slice" Type="int" Range="[-1,50]" Default="0" Desc="Slice to plot. -1 for all" />
     <Argument  Name="DarkHoleOnly" Type="int" Range="[0,1]" Default="1" Desc="0: Plot profile in dark hole only; 1: Plot outer profile as well." />
     <Argument  Name="contr_yunit" Type="int" Range="[0,2]" Default="0" Desc="0: Standard deviation; 1: Median; 2: Mean." />
     <Argument  Name="contr_xunit" Type="int" Range="[0,1]" Default="0" Desc="0: Arcsec; 1: lambda/D." />
     <Argument  Name="yscale" Type="int" Range="[0,1]" Default="0" Desc="0: Auto y axis scaling; 1: Manual scaling." />
     <Argument  Name="contr_yaxis_type" Type="int" Range="[0,1]" Default="1" Desc="0: Linear; 1: Log" />
     <Argument  Name="contr_yaxis_min" Type="float" Range="[0.,1.]" Default="0.00000001" Desc="Y axis minimum" />
     <Argument  Name="contr_yaxis_max" Type="float" Range="[0.,1.]" Default="1." Desc="Y axis maximum" />
 </Primitive>
 <Primitive Name="Measure GPI distortion from grid pattern" IDLFunc="gpi_measure_distortion" Comment=" Measure GPI distortion from grid pattern" Order=" 2.44" Type=" Calibration HIDDEN" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Measure Polarization Spot Calibration" IDLFunc="gpi_measure_polarization_spot_calibration" Comment=" Derive polarization calibration files from a flat field image." Order=" 1.8" Type=" Calibration" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1078" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1028" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.4" Desc="Spectral spacing perpendicular to the dispersion axis at the detcetor in pixel" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="2.18" Desc="Micro-pupil pattern" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2.5" Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="FitWidth" Type="float" Range="[-10.,10.]" Default="3" Desc="Size of box around a spot used to find center" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" />
     <Argument  Name="Display" Type="int" Range="[0,1]" Default="1" />
 </Primitive>
 <Primitive Name="Measure satellite spot locations" IDLFunc="gpi_measure_satellite_spot_locations" Comment=" Measure the locations of the satellite spots in the datacube, and save the results to the FITS keyword headers." Order=" 2.44" Type=" Calibration,SpectralScience" >
     <Argument  Name="refine_fits" Type="int" Range="[0,1]" Default="1" Desc="0: Use wavelength scaling only; 1: Fit each slice" />
     <Argument  Name="reference_index" Type="int" Range="[-1,50]" Default="-1" Desc="Index of slice to use for initial satellite detection. -1 for Auto." />
     <Argument  Name="search_window" Type="int" Range="[1,50]" Default="20" Desc="Radius of aperture used for locating satellite spots." />
     <Argument  Name="highpass" Type="int" Range="[0,25]" Default="1" Desc="1: Use high pass filter (default size) 0: don't 2+: size of highpass filter box" />
     <Argument  Name="constrain" Type="int" Range="[0,1]" Default="0" Desc="1: Constrain distance between sat spots by band; 0: Unconstrained search." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="loc_input" Type="int" Range="[0,2]" Default="0" Desc="0: Find spots automatically; 1: Use values below as initial satellite spot location" />
     <Argument  Name="x1" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of top left spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y1" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of top left spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="x2" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of bottom left spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y2" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of bottom left spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="x3" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of top right spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y3" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of top right spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="x4" Type="int" Range="[0,300]" Default="0" Desc="approx x-location of bottom right spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
     <Argument  Name="y4" Type="int" Range="[0,300]" Default="0" Desc="approx y-location of bottom right spot on reference slice of the datacube in pixels (not considered if CalibrationFile is defined)" />
 </Primitive>
 <Primitive Name="Measure satellite spot peak fluxes" IDLFunc="gpi_measure_satellite_spot_peak_fluxes" Comment=" Calculate peak fluxes of satellite spots in datacubes " Order=" 2.45" Type=" Calibration,SpectralScience" >
     <Argument  Name="gauss_fit" Type="int" Range="[0,1]" Default="1" Desc="0: Extract maximum pixel; 1: Correlate with Gaussian to find peak" />
     <Argument  Name="reference_index" Type="int" Range="[0,50]" Default="0" Desc="Index of slice to use for initial satellite detection." />
     <Argument  Name="ap_rad" Type="int" Range="[1,50]" Default="7" Desc="Radius of aperture used for finding peaks." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Measure Star Position for Polarimetry" IDLFunc="gpi_measure_star_position_for_polarimetry" Comment=" Finds the location of the occulted star in polarimetry mode, and save the results to the FITS keyword headers." Order=" 2.445" Type=" Calibration, PolarimetricScience" >
     <Argument  Name="x0" Type="int" Range="[0,300]" Default="147" Desc="initial guess for image center x-coordinate" />
     <Argument  Name="y0" Type="int" Range="[0,300]" Default="147" Desc="inital guess ofr image center y-coordinate" />
     <Argument  Name="search_window" Type="int" Range="[1,50]" Default="5" Desc="Radius of search window to search for the center" />
     <Argument  Name="mask_radius" Type="int" Range="[0,100]" Default="50" Desc="Radius of center of image to mask (centered on x0, y0 inputs)" />
     <Argument  Name="highpass" Type="int" Range="[0,1]" Default="1" Desc="1: Use high pass filter 0: don't" />
     <Argument  Name="lower_threshold" Type="float" Range="[-100000,100000]" Default="-100" Desc="Lower pixel values will be converted to this value" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Measure Wavelength Calibration" IDLFunc="gpi_measure_wavelength_calibration" Comment=" Derive wavelength calibration from an arc lamp or flat-field image." Order=" 1.7" Type=" Calibration" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1024" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.8" Desc="Spectral spacing perpendicular to the dispersion axis at the image center [pixel]" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="-1.8" Desc="Ratio of spectral offset parallel to dispersion over spectral spacing perpendicular to dispersion" />
     <Argument  Name="emissionlinesfile" Type="string"  Default="AUTOMATIC" Desc="File of emission lines." />
     <Argument  Name="wav_of_centrXYpos" Type="int" Range="[1,2]" Default="2" Desc="1 if centrX-Ypos is the smallest-wavelength peak of the band; 2 if centrX-Ypos refer to 1.5microns" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2." Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="maxtilt" Type="float" Range="[-360.,360.]" Default="10." Desc="Allowed maximum tilt fluctuation (in degree) between adjacent mlens" />
     <Argument  Name="centroidmethod" Type="int" Range="[0,1]" Default="0" Desc="Centroid method: 0 means barycentric (fast), 1 means gaussian fit (slow)" />
     <Argument  Name="medfilter" Type="int" Range="[0,1]" Default="1" Desc="1: Median filtering of dispersion coeff and tilts with a (5x5) median filtering" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="iscalib" Type="int" Range="[0,1]" Default="1" Desc="1: save to Calibrations Database, 0: save in regular reduced data dir" />
     <Argument  Name="lamp_override" Type="int" Range="[0,1]" Default="0" Desc="0,1: override the filter/lamp combinations?" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying wavcal file, 0: no display " />
     <Argument  Name="tests" Type="int" Range="[0,3]" Default="0" Desc="1 for extensive tests " />
     <Argument  Name="testsDST" Type="int" Range="[0,3]" Default="0" Desc="1 for DST tests " />
 </Primitive>
 <Primitive Name="Median Combine ADI datacubes" IDLFunc="gpi_median_combine_adi_datacubes" Comment=" Median combine all residual datacubes after an ADI (or LOCI) speckle suppression." Order=" 4.5" Type=" SpectralScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="10" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Noise and Flux Analysis" IDLFunc="gpi_noise_and_flux_analysis" Comment=" Store a few key values as fits keywords in the file. It can generate anciliary files too." Order=" 2.1" Type=" HIDDEN" >
     <Argument  Name="Flux" Type="int" Range="[0,1]" Default="1" Desc='Trigger flux analysis' />
     <Argument  Name="StddevMed" Type="int" Range="[0,2]" Default="1" Desc='Trigger the standard deviation (and median) analysis of the image. if StddevMed=1, only keywords and log are produced. If StddevMed=2, fits files are generated with a sliding median and standard deviation.' />
     <Argument  Name="Width" Type="int" Range="[3,2048]" Default="101" Desc='If Stddev = 2, Width of the moving rectangle. It has to be odd.' />
     <Argument  Name="PixelsSkipped" Type="int" Range="[0,2047]" Default="100" Desc='If Stddev = 2, Pixels skipped between two points' />
     <Argument  Name="MicroNoise" Type="int" Range="[0,1]" Default="1" Desc='Trigger the microphonics noise analysis' />
     <Argument  Name="CalibrationFile" Type="string" Default="AUTOMATIC" Desc="Filename of the desired microphonics model file to be read" />
     <Argument  Name="FourierTransf" Type="int" Range="[0,1,2]" Default="1" Desc='1: frequency 0 on the bottom left. 2: frequencies 0 will be centered on the image.' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Normalize polarimetry flat field" IDLFunc="gpi_normalize_polarimetry_flat_field" Comment=" Normalize a polarimetry-mode flat field to unity." Order=" 3.1992" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Pad Wavelength Calibration Edges" IDLFunc="gpi_pad_wavelength_calibration_edges" Comment="  pads the outer edges of the wavecal via extrapolation to cover lenslets whose spectra only partially fall on the detector field of view." Order=" 4.6" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: Save output to disk, 0: Don't save" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
 </Primitive>
 <Primitive Name="Parallelized Polarization Spot Calibration" IDLFunc="gpi_parallelized_polarization_spot_calibration" Comment=" Derive polarization calibration files from a flat field image." Order=" 1.8" Type=" Testing" >
     <Argument  Name="nlens" Type="int" Range="[0,400]" Default="281" Desc="side length of  the  lenslet array " />
     <Argument  Name="centrXpos" Type="int" Range="[0,2048]" Default="1078" Desc="Initial approximate x-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="centrYpos" Type="int" Range="[0,2048]" Default="1028" Desc="Initial approximate y-position [pixel] of central peak at 1.5microns" />
     <Argument  Name="w" Type="float" Range="[0.,10.]" Default="4.4" Desc="Spectral spacing perpendicular to the dispersion axis at the detcetor in pixel" />
     <Argument  Name="P" Type="float" Range="[-7.,7.]" Default="2.18" Desc="Micro-pupil pattern" />
     <Argument  Name="maxpos" Type="float" Range="[-7.,7.]" Default="2.5" Desc="Allowed maximum location fluctuation (in pixel) between adjacent mlens" />
     <Argument  Name="FitWidth" Type="float" Range="[-10.,10.]" Default="3" Desc="Size of box around a spot used to find center" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" />
     <Argument  Name="Display" Type="int" Range="[0,1]" Default="1" />
 </Primitive>
 <Primitive Name="Populate Flexure Shifts vs Elevation Table" IDLFunc="gpi_populate_flexure_shifts_vs_elevation_table" Comment=" Derive shifts vs elevation lookup table." Order=" 4.2" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="1" Desc="-1 = No display; 0 = New (unused) window else = Window number to display diagnostic plot in." />
     <Argument  Name="saveplots" Type="string" Range="[yes|no]" Default="no" Desc='Save diagnostic plots to PS files after running? [yes|no]' />
 </Primitive>
 <Primitive Name="Quality Check Wavelength Calibration" IDLFunc="gpi_quality_check_wavelength_calibration" Comment=" Performs a basic quality check on a wavecal based on the statistical distribution of measured inter-lenslet spacings. " Order=" 4.5" Type=" Calibration" >
     <Argument  Name="error_action" Type="string" Range="[Fail|Ask_user]" Default="Ask_user" Desc="If the quality check fails, should the recipe immediately fail or should I alert the user and ask what they want to do?" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display diagnostic plot." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
 </Primitive>
 <Primitive Name="Quick Wavelength Solution Update" IDLFunc="gpi_quick_wavelength_solution_update" Comment=" Given an existing wavecal and a new Xe lamp image, this primitive updates the wavecal based on the X,Y positions measured for a subset of the Xe spectra. " Order=" 1.7" Type=" Calibration" >
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display each lenslet in comparison to the detector lenslet in." />
     <Argument  Name="spacing" Type="Int" Range="[0,20]" Default="10" Desc="Test every Nth lenslet for this value of N." />
     <Argument  Name="boxsizex" Type="Int" Range="[0,15]" Default="7" Desc="x dimension of a lenslet cutout" />
     <Argument  Name="boxsizey" Type="Int" Range="[0,50]" Default="24" Desc="y dimension of a lenslet cutout" />
     <Argument  Name="xoffset" Type="Int" Range="[-10,10]" Default="0" Desc="x offset guess from prior wavecal." />
     <Argument  Name="yoffset" Type="Int" Range="[-20,20]" Default="0" Desc="y offset guess from prior wavecal." />
     <Argument  Name="whichpsf" Type="Int" Range="[0,1]" Default="0" Desc="Type of psf 0;gaussian, 1;microlens" />
     <Argument  Name="CalibrationFile" Type='String' CalFileType="wavecal" Default="AUTOMATIC" Desc="Filename of the desired wavelength calibration file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="AutoOffset" Type="int" Range="[0,1]" Default="0" Desc="Automatically determine x/yoffset values 0;NO, 1;YES" />
     <Argument  Name="gpitvim_dispgrid" Type="int" Range="[0,500]" Default="15" Desc="1-500: choose gpitv session for displaying image output and wavcal grid overplotted, 0: no display " />
 </Primitive>
 <Primitive Name="Remove Flat Lamp spectrum" IDLFunc="gpi_remove_flat_lamp_spectrum" Comment=" Fit the lamp spectrum and remove it (for delivering flat field cubes)" Order=" 2.25" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
     <Argument  Name="method" Type="string" Range="polyfit|linfit|blackbody|none" Default="blackbody" Desc="Method to use for removing lamp spectrum" />
 </Primitive>
 <Primitive Name="Remove Persistence from Previous Images" IDLFunc="gpi_remove_persistence_from_previous_images" Comment=" Determines/Removes persistence of previous images" Order=" 1.2" Type=" ALL" >
     <Argument  Name="CalibrationFile" Type="String" CalFileType="persis" Default="AUTOMATIC" Desc="Filename of the persistence_parameter file to be read" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display "  />
 </Primitive>
 <Primitive Name="Rotate 2D image" IDLFunc="gpi_rotate_2d_image" Comment=" Rotate a 2d image by some multiple of 90 degrees " Order=" 1.9" Type=" Testing" >
     <Argument  Name="Direction" Type="int" Range="[0,3]" Default="1" Desc="Rotation Counterclockwise:0=None,1=90deg,2=180deg,3=270deg" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Rotate Field of View Square" IDLFunc="gpi_rotate_field_of_view_square" Comment=" Rotate datacubes so that the field of view is squarely aligned with the image axes. " Order=" 3.9" Type=" SpectralScience,PolarimetricScience" >
     <Argument  Name="Method" Type="enum" Range="CUBIC|FFT" Default="CUBIC" />
     <Argument  Name="crop" Type="int" Range="[0,1]" Default="0" Desc="Set to 1 to crop out non-illuminated pixels" />
     <Argument  Name="Show" Type="int" Range="[0,1]" Default="0" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Rotate North Up" IDLFunc="gpi_rotate_north_up" Comment=" Rotate datacubes so that north is up and east is left. " Order=" 3.9" Type=" SpectralScience,PolarimetricScience" >
     <Argument  Name="Rot_Method" Type="string" Range="CUBIC|FFT" Default="CUBIC" Desc='Method to compute the rotation' />
     <Argument  Name="Center_Method" Type="string" Range="HEADERS|MANUAL" Default="HEADERS" Desc="Determine the center of rotation from FITS header keywords, manual entry" />
     <Argument  Name="centerx" Type="int" Range="[0,281]" Default="140" Desc="Center X Pixel if Center_Method=Manual" />
     <Argument  Name="centery" Type="int" Range="[0,281]" Default="140" Desc="Center Y Pixel if Center_Method=Manual" />
     <Argument  Name="pivot" Type ="int" Range="[0,1]" Default="0" Desc="Pivot about the center of the image? 0 = No"  />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Save Output" IDLFunc="gpi_save_output" Comment=" Save output to disk as a FITS file. Note that you can often do this from another module by setting the 'save=1' option; this is a redundant way to specify that. " Order=" 10.0" Type=" ALL" >
     <Argument  Name='suffix' Type='string' default='default' Desc="choose the suffix" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Shift 2D Image" IDLFunc="gpi_shift_2d_image" Comment=" Shift 2D image, by integer or fractional pixel amounts.  Doesn't shift ref pixels. " Order=" 1.9" Type=" Testing,Calibration" >
     <Argument  Name="dx" Type="float" Range="[-10,10]" Default="0" Desc="shift amount in X direction" />
     <Argument  Name="dy" Type="float" Range="[-10,10]" Default="0" Desc="shift amount in Y direction" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Simple SDI of post ADI residual" IDLFunc="gpi_simple_sdi_of_post_adi_residual" Comment=" Apply SSDI to create a 2D subtracted image from a cube. Given the user's specified wavelength ranges, extract the 3D datacube slices for each of those wavelength ranges. Collapse these down into 2D images by simply averaging the values at each lenslet (ignoring NANs).  Rescale Image1, then compute  diffImage = I1scaled - k* I2" Order=" 4.3" Type=" SpectralScience" >
     <Argument  Name="L1Min" Type="float" Range="[0.9,2.5]" Default="1.55" Desc="Wavelength range 1, minimum wavelength [in microns]" />
     <Argument  Name="L1Max" Type="float" Range="[0.9,2.5]" Default="1.57" Desc="Wavelength range 1, maximum wavelength [in microns]" />
     <Argument  Name="L2Min" Type="float" Range="[0.9,2.5]" Default="1.60" Desc="Wavelength range 2, minimum wavelength [in microns]" />
     <Argument  Name="L2Max" Type="float" Range="[0.9,2.5]" Default="1.65" Desc="Wavelength range 2, maximum wavelength [in microns]" />
     <Argument  Name="k" Type="float" Range="[0,10]" Default="1.0" Desc="Scaling factor of Intensity(wav_range2) with diffImage = I1scaled - k* I2" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Simple Spectral Differential Imaging" IDLFunc="gpi_simple_spectral_differential_imaging" Comment=" Apply SSDI to create a 2D subtracted image from a cube. Given the user's specified wavelength ranges, extract the 3D datacube slices for each of those wavelength ranges. Collapse these down into 2D images by simply averaging the values at each lenslet (ignoring NANs).  Rescale Image1, then compute  diffImage = I1scaled - k* I2" Order=" 2.61" Type=" SpectralScience" >
     <Argument  Name="L1Min" Type="float" Range="[0.9,2.5]" Default="1.55" Desc="Wavelength range 1, minimum wavelength [in microns]" />
     <Argument  Name="L1Max" Type="float" Range="[0.9,2.5]" Default="1.57" Desc="Wavelength range 1, maximum wavelength [in microns]" />
     <Argument  Name="L2Min" Type="float" Range="[0.9,2.5]" Default="1.60" Desc="Wavelength range 2, minimum wavelength [in microns]" />
     <Argument  Name="L2Max" Type="float" Range="[0.9,2.5]" Default="1.65" Desc="Wavelength range 2, maximum wavelength [in microns]" />
     <Argument  Name="k" Type="float" Range="[0,10]" Default="1.0" Desc="Scaling factor of Intensity(wav_range2) with diffImage = I1scaled - k* I2" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="ReuseOutput" Type="int" Range="[0,1]" Default="1" Desc="1: keep output for following primitives, 0: don't keep" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Smooth a 3D Cube" IDLFunc="gpi_smooth_cube" Comment=" Smooth a cube by convolution with a Gaussian kernel, repeated for each slice of the cube." Order=" 3.5" Type=" PolarimetricScience,SpectralScience,Calibration" >
     <Argument  Name="Smooth_FWHM" Type="int" Range="[0,100]" Default="3" Desc="FWHM of gaussian kernel" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Speckle alignment" IDLFunc="gpi_speckle_alignment" Comment=" This recipe rescales datacube PSF slices with respect to a chosen reference PSF slice." Order=" 2.61" Type=" SpectralScience" >
     <Argument  Name="k" Type="int" Range="[0,100]" Default="0" Desc="Slice of the reference PSF" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="5" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract background from 2D image" IDLFunc="gpi_subtract_background_from_2d_image" Comment="  Subtract 2D background based on the regions in between the spectra" Order=" 1.12 " Type=" Testing" >
     <Argument  Name="method" Type="string" Range="[threshhold|calfile]" Default="calfile" Desc='Find background based on image value threshhold cut, or calibration file spectra/spot locations?' />
     <Argument  Name="abort_fraction" Type="float" Range="[0.0,1.0]" Default="0.9" Desc="Necessary fraction of pixels in mask to continue - set at 0.9 to ensure quicklook tool is robust" />
     <Argument  Name="chan_offset_correction" Type="int" Range="[0,1]" Default="0" Desc="Tries to correct for channel bias offsets - useful when no dark is available" />
     <Argument  Name="fraction" Type="float" Range="[0.0,1.0]" Default="0.7" Desc="What fraction of the total pixels in a row should be masked" />
     <Argument  Name="high_limit" Type="float" Range="[0,Inf]" Default="1" Desc="Pixel value where exceeding values are assigned a larger mask" />
     <Argument  Name="Save_stripes" Type="int" Range="[0,1]" Default="0" Desc="Save the striping noise image subtracted from frame?" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: Save output to disk, 0: Don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="1" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract Dark Background" IDLFunc="gpi_subtract_dark_background" Comment=" Subtract a dark frame. " Order=" 1.1" Type=" ALL" >
     <Argument  Name="CalibrationFile" Type="string" CalFileType="dark" Default="AUTOMATIC" Desc="Name of dark file to subtract" />
     <Argument  Name="RequireExactMatch" Type="int" Range="[0,1]" Default="0" Desc="Must dark calibration file exactly match in integration time, or is scaling from a different exposure time allowed?" />
     <Argument  Name="Interpolate" Type="int" Range="[0,1]" Default="0" Desc="Interpolate based on JD between prior and subsequent available darks" />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract Mean Stellar Polarization" IDLFunc="gpi_subtract_mean_stellar_polarization" Comment=" This description of the processing or calculation will show ; up in the Recipe Editor GUI. This is an example template for creating new ; primitives. It multiples any input cube by a constant value." Order=" 5.0" Type=" PolarimetricScience" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract Thermal/Sky Background Cube if K band" IDLFunc="gpi_subtract_thermal_sky_background_cube_if_k_band" Comment=" Subtract a thermal/sky cube " Order=" 2.35" Type=" ALL" >
     <Argument  Name="CalibrationFile" Type="string" CalFileType="bkgnd_cube" Default="AUTOMATIC" Desc='Name of thermal/sky background cube to subtract' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Override_scaling" Type="float" Range="[0,10]" Default="1.0" Desc="Set to value other than 1 to manually adjust the background image flux scaling to better match the science data" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Subtract Thermal/Sky Background if K band" IDLFunc="gpi_subtract_thermal_sky_background_if_k_band" Comment=" Subtract a dark frame. " Order=" 1.2" Type=" ALL" >
     <Argument  Name="CalibrationFile" Type="string" CalFileType="bkgnd" Default="AUTOMATIC" Desc='Name of thermal background file to subtract' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Override_scaling" Type="float" Range="[0,10]" Default="1.0" Desc="Set to value other than 1 to manually adjust the background image flux scaling to better match the science data" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Update Spot Shifts for Flexure" IDLFunc="gpi_update_spot_shifts_for_flexure" Comment=" Extract a 3D datacube from a 2D image. Spatial integration (3 pixels) along the dispersion axis" Order=" 1.34" Type=" SpectralScience, Calibration, PolarimetricScience" >
     <Argument  Name="method" Type="string" Range="[None|Manual|Lookup|Auto]" Default="None" Desc='How to correct spot shifts due to flexure? [None|Manual|Lookup|Auto]' />
     <Argument  Name="manual_dx" Type="float" Range="[-10,10]" Default="0" Desc="If method=Manual, the X shift of spectra at the center of the detector" />
     <Argument  Name="manual_dy" Type="float" Range="[-10,10]" Default="0" Desc="If method=Manual, the Y shift of spectra at the center of the detector" />
     <Argument  Name="Display" Type="int" Range="[-1,100]" Default="-1" Desc="-1 = No display; 0 = New (unused) window; else = Window number to display diagnostic plot." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="Update World Coordinates" IDLFunc="gpi_update_world_coordinates" Comment=" Add wcs info, assuming target star is precisely centered." Order=" 2.9" Type=" ALL" >
     <Argument  Name="CalibrationFile" Type="string" CalFileType="astrom" Default="AUTOMATIC" Desc='Name of astrometry offset calibratoin file' />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="0" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="0" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
 <Primitive Name="2D Wavelength Solution" IDLFunc="gpi_wavelength_solution_2d" Comment=" This primitive uses an existing wavelength solution file to construct a new wavelength solution file by simulating the detector image and performing a least squares fit." Order=" 1.7" Type=" Calibration" >
     <Argument  Name="display" Type="Int" Range="[0,1]" Default="0" Desc="Whether or not to plot each lenslet spectrum model in comparison to the detector measured spectrum: 1;display, 0;no display" />
     <Argument  Name="whichpsf" Type="Int" Range="[0,1]" Default="0" Desc="Type of lenslet PSF model, 0: gaussian, 1: microlens" />
     <Argument  Name="parallel" Type="Int" Range="[0,1]" Default="0" Desc="Option for Parallelization,  0: none, 1: parallel" />
     <Argument  Name="numsplit" Type="Int" Range="[0,100]" Default="0" Desc="Number of cores for parallelization. Set to 0 for autoselect." />
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="Smooth" Type="int" Range="[0,1]" Default="1" Desc="1: Smooth over poorly fit lenslets in final datacube; 0:NO, 1:YES" />
     <Argument  Name="Save_model_image" Type="int" Range="[0,1]" Default="0" Desc="1: save 2d detector model fit image to disk, 0:don't save" />
     <Argument  Name="CalibrationFile" Type="wavcal" Default="AUTOMATIC" Desc="Filename of the desired reference wavelength calibration file to be read" />
     <Argument  Name="Save_model_params" Type="int" Range="[0,1]" Default="0" Desc="1: save model nuisance parameters to disk, 0: don't save" />
     <Argument  Name="AutoOffset" Type="int" Range="[0,1]" Default="0" Desc="Automatically determine x/yoffset values 0;NO, 1;YES" />
 </Primitive>
 <Primitive Name="Stores calibration in dataset" IDLFunc="store_calib_in_dataset" Comment=" Stores the current calibration into the dataset structure." Order=" 3.0" Type=" Calibration" >
     <Argument  Name="Save" Type="int" Range="[0,1]" Default="1" Desc="1: save output on disk, 0: don't save" />
     <Argument  Name="gpitv" Type="int" Range="[0,500]" Default="2" Desc="1-500: choose gpitv session for displaying output, 0: no display " />
 </Primitive>
</Config>
